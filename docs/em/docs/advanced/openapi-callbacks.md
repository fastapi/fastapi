# ğŸ—„ â²

ğŸ‘† ğŸ’ª âœ ğŸ› ï¸ â®ï¸ *â¡ ğŸ› ï¸* ğŸ‘ˆ ğŸ’ª â² ğŸ“¨ *ğŸ”¢ ğŸ› ï¸* âœ ğŸ‘± ğŸ™† (ğŸ² ğŸ ğŸ‘©â€ğŸ’» ğŸ‘ˆ ğŸ”œ *âš™ï¸* ğŸ‘† ğŸ› ï¸).

ğŸ› ï¸ ğŸ‘ˆ ğŸ”¨ ğŸ•â” ğŸ‘† ğŸ› ï¸ ğŸ“± ğŸ¤™ *ğŸ”¢ ğŸ› ï¸* ğŸ“› "â²". â†©ï¸ ğŸ–¥ ğŸ‘ˆ ğŸ”¢ ğŸ‘©â€ğŸ’» âœ ğŸ“¨ ğŸ“¨ ğŸ‘† ğŸ› ï¸ &amp; â¤´ï¸ ğŸ‘† ğŸ› ï¸ *ğŸ¤™ ğŸ”™*, ğŸ“¨ ğŸ“¨ *ğŸ”¢ ğŸ› ï¸* (ğŸ‘ˆ ğŸ² âœ ğŸ ğŸ‘©â€ğŸ’»).

ğŸ‘‰ ğŸ’¼, ğŸ‘† ğŸ’ª ğŸ’š ğŸ“„ â” ğŸ‘ˆ ğŸ”¢ ğŸ› ï¸ *ğŸ”œ* ğŸ‘€ ğŸ’–. âš«ï¸â” *â¡ ğŸ› ï¸* âš«ï¸ ğŸ”œ âœ”ï¸, âš«ï¸â” ğŸ’ª âš«ï¸ ğŸ”œ âŒ›, âš«ï¸â” ğŸ“¨ âš«ï¸ ğŸ”œ ğŸ“¨, â™’ï¸.

## ğŸ“± â®ï¸ â²

â¡ï¸ ğŸ‘€ ğŸŒ ğŸ‘‰ â®ï¸ ğŸ–¼.

ğŸŒˆ ğŸ‘† ğŸ› ï¸ ğŸ“± ğŸ‘ˆ âœ” ğŸ— ğŸ§¾.

ğŸ‘‰ ğŸ§¾ ğŸ”œ âœ”ï¸ `id`, `title` (ğŸ“¦), `customer`, &amp; `total`.

ğŸ‘©â€ğŸ’» ğŸ‘† ğŸ› ï¸ (ğŸ”¢ ğŸ‘©â€ğŸ’») ğŸ”œ âœ ğŸ§¾ ğŸ‘† ğŸ› ï¸ â®ï¸ ğŸ¤ ğŸ“¨.

â¤´ï¸ ğŸ‘† ğŸ› ï¸ ğŸ”œ (â¡ï¸ ğŸŒˆ):

* ğŸ“¨ ğŸ§¾ ğŸ•´ ğŸ”¢ ğŸ‘©â€ğŸ’».
* ğŸ“ˆ ğŸ’¸.
* ğŸ“¨ ğŸ“¨ ğŸ”™ ğŸ› ï¸ ğŸ‘©â€ğŸ’» (ğŸ”¢ ğŸ‘©â€ğŸ’»).
    * ğŸ‘‰ ğŸ”œ ğŸ”¨ ğŸ“¨ ğŸ¤ ğŸ“¨ (âšªï¸â¡ï¸ *ğŸ‘† ğŸ› ï¸*) *ğŸ”¢ ğŸ› ï¸* ğŸšš ğŸ‘ˆ ğŸ”¢ ğŸ‘©â€ğŸ’» (ğŸ‘‰ "â²").

## ğŸ˜ **FastAPI** ğŸ“±

â¡ï¸ ğŸ¥‡ ğŸ‘€ â” ğŸ˜ ğŸ› ï¸ ğŸ“± ğŸ”œ ğŸ‘€ ğŸ’– â­ â â².

âš«ï¸ ğŸ”œ âœ”ï¸ *â¡ ğŸ› ï¸* ğŸ‘ˆ ğŸ”œ ğŸ“¨ `Invoice` ğŸ’ª, &amp; ğŸ”¢ ğŸ”¢ `callback_url` ğŸ‘ˆ ğŸ”œ ğŸ”Œ ğŸ“› â².

ğŸ‘‰ ğŸ• ğŸ“¶ ğŸ˜, ğŸŒ… ğŸ“Ÿ ğŸ² âª ğŸ˜° ğŸ‘†:

```Python hl_lines="9-13  36-53"
{!../../../docs_src/openapi_callbacks/tutorial001.py!}
```

!!! tip
     `callback_url` ğŸ”¢ ğŸ”¢ âš™ï¸ Pydantic <a href="https://pydantic-docs.helpmanual.io/usage/types/#urls" class="external-link" target="_blank">ğŸ“›</a> ğŸ†.

ğŸ•´ ğŸ†• ğŸ‘œ `callbacks=messages_callback_router.routes` âŒ *â¡ ğŸ› ï¸ ğŸ‘¨â€ğŸ¨*. ğŸ‘¥ ğŸ”œ ğŸ‘€ âš«ï¸â” ğŸ‘ˆ â­.

## ğŸ”¬ â²

â˜‘ â² ğŸ“Ÿ ğŸ”œ ğŸª€ ğŸ™‡ ğŸ”› ğŸ‘† ğŸ‘ ğŸ› ï¸ ğŸ“±.

&amp; âš«ï¸ ğŸ”œ ğŸ² ğŸª€ ğŸ“š âšªï¸â¡ï¸ 1ï¸âƒ£ ğŸ“± â­.

âš«ï¸ ğŸ’ª 1ï¸âƒ£ âš–ï¸ 2ï¸âƒ£ â¸ ğŸ“Ÿ, ğŸ’–:

```Python
callback_url = "https://example.com/api/v1/invoices/events/"
httpx.post(callback_url, json={"description": "Invoice paid", "paid": True})
```

âœ‹ï¸ ğŸ² ğŸ† âš  ğŸ• â² âš’ ğŸ’­ ğŸ‘ˆ ğŸ‘† ğŸ› ï¸ ğŸ‘©â€ğŸ’» (ğŸ”¢ ğŸ‘©â€ğŸ’») ğŸ› ï¸ *ğŸ”¢ ğŸ› ï¸* â˜‘, ğŸ›„ ğŸ’½ ğŸ‘ˆ *ğŸ‘† ğŸ› ï¸* ğŸ”œ ğŸ“¨ ğŸ“¨ ğŸ’ª â², â™’ï¸.

, âš«ï¸â” ğŸ‘¥ ğŸ”œ â­ ğŸš® ğŸ“Ÿ ğŸ“„ â” ğŸ‘ˆ *ğŸ”¢ ğŸ› ï¸* ğŸ”œ ğŸ‘€ ğŸ’– ğŸ“¨ â² âšªï¸â¡ï¸ *ğŸ‘† ğŸ› ï¸*.

ğŸ‘ˆ ğŸ§¾ ğŸ”œ ğŸ¦ ğŸ†™ ğŸ¦ ğŸš `/docs` ğŸ‘† ğŸ› ï¸, &amp; âš«ï¸ ğŸ”œ â¡ï¸ ğŸ”¢ ğŸ‘©â€ğŸ’» ğŸ’­ â” ğŸ— *ğŸ”¢ ğŸ› ï¸*.

ğŸ‘‰ ğŸ–¼ ğŸš« ğŸ› ï¸ â² âš«ï¸ (ğŸ‘ˆ ğŸ’ª â¸ ğŸ“Ÿ), ğŸ•´ ğŸ§¾ ğŸ•.

!!! tip
    â˜‘ â² ğŸ‡ºğŸ‡¸ğŸ” ğŸ“¨.

    ğŸ•â” ğŸ› ï¸ â² ğŸ‘†, ğŸ‘† ğŸ’ª âš™ï¸ ğŸ•³ ğŸ’– <a href="https://www.python-httpx.org" class="external-link" target="_blank">ğŸ‡¸ğŸ‡²</a> âš–ï¸ <a href="https://requests.readthedocs.io/" class="external-link" target="_blank">ğŸ“¨</a>.

## âœ â² ğŸ§¾ ğŸ“Ÿ

ğŸ‘‰ ğŸ“Ÿ ğŸ† ğŸš« ğŸ› ï¸ ğŸ‘† ğŸ“±, ğŸ‘¥ ğŸ•´ ğŸ’ª âš«ï¸ *ğŸ“„* â” ğŸ‘ˆ *ğŸ”¢ ğŸ› ï¸* ğŸ”œ ğŸ‘€ ğŸ’–.

âœ‹ï¸, ğŸ‘† âª ğŸ’­ â” ğŸ’ª âœ ğŸ§ ğŸ§¾ ğŸ› ï¸ â®ï¸ **FastAPI**.

ğŸ‘¥ ğŸ”œ âš™ï¸ ğŸ‘ˆ ğŸ ğŸ’¡ ğŸ“„ â” *ğŸ”¢ ğŸ› ï¸* ğŸ”œ ğŸ‘€ ğŸ’–... ğŸ— *â¡ ğŸ› ï¸(â“‚)* ğŸ‘ˆ ğŸ”¢ ğŸ› ï¸ ğŸ”œ ğŸ› ï¸ (ğŸ• ğŸ‘† ğŸ› ï¸ ğŸ”œ ğŸ¤™).

!!! tip
    ğŸ•â” âœ ğŸ“Ÿ ğŸ“„ â², âš«ï¸ ğŸ’ª âš  ğŸŒˆ ğŸ‘ˆ ğŸ‘† ğŸ‘ˆ *ğŸ”¢ ğŸ‘©â€ğŸ’»*. &amp; ğŸ‘ˆ ğŸ‘† â³ ğŸ› ï¸ *ğŸ”¢ ğŸ› ï¸*, ğŸš« *ğŸ‘† ğŸ› ï¸*.

    ğŸ• ğŸ› ï¸ ğŸ‘‰ â˜ ğŸ‘ ( *ğŸ”¢ ğŸ‘©â€ğŸ’»*) ğŸ’ª â„¹ ğŸ‘† ğŸ’­ ğŸ’– âš«ï¸ ğŸŒ… â­ ğŸŒâ” ğŸš® ğŸ”¢, Pydantic ğŸ· ğŸ’ª, ğŸ“¨, â™’ï¸. ğŸ‘ˆ *ğŸ”¢ ğŸ› ï¸*.

### âœ â² `APIRouter`

ğŸ¥‡ âœ ğŸ†• `APIRouter` ğŸ‘ˆ ğŸ”œ ğŸ”Œ 1ï¸âƒ£ âš–ï¸ ğŸŒ… â².

```Python hl_lines="3  25"
{!../../../docs_src/openapi_callbacks/tutorial001.py!}
```

### âœ â² *â¡ ğŸ› ï¸*

âœ â² *â¡ ğŸ› ï¸* âš™ï¸ ğŸ `APIRouter` ğŸ‘† âœ ğŸ”›.

âš«ï¸ ğŸ”œ ğŸ‘€ ğŸ’– ğŸ˜ FastAPI *â¡ ğŸ› ï¸*:

* âš«ï¸ ğŸ”œ ğŸ² âœ”ï¸ ğŸ“„ ğŸ’ª âš«ï¸ ğŸ”œ ğŸ“¨, âœ… `body: InvoiceEvent`.
*  &amp; âš«ï¸ ğŸ’ª âœ”ï¸ ğŸ“„ ğŸ“¨ âš«ï¸ ğŸ”œ ğŸ“¨, âœ… `response_model=InvoiceEventReceived`.

```Python hl_lines="16-18  21-22  28-32"
{!../../../docs_src/openapi_callbacks/tutorial001.py!}
```

ğŸ“¤ 2ï¸âƒ£ ğŸ‘‘ ğŸ”º âšªï¸â¡ï¸ ğŸ˜ *â¡ ğŸ› ï¸*:

* âš«ï¸ ğŸš« ğŸ’ª âœ”ï¸ ğŸ™† â˜‘ ğŸ“Ÿ, â†©ï¸ ğŸ‘† ğŸ“± ğŸ”œ ğŸ™… ğŸ¤™ ğŸ‘‰ ğŸ“Ÿ. âš«ï¸ ğŸ•´ âš™ï¸ ğŸ“„ *ğŸ”¢ ğŸ› ï¸*. , ğŸ”¢ ğŸ’ª âœ”ï¸ `pass`.
*  *â¡* ğŸ’ª ğŸ”Œ <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.2.md#key-expression" class="external-link" target="_blank">ğŸ—„ 3ï¸âƒ£ ğŸ§¬</a> (ğŸ‘€ ğŸŒ– ğŸ”›) ğŸŒâ” âš«ï¸ ğŸ’ª âš™ï¸ ğŸ”¢ â®ï¸ ğŸ”¢ &amp; ğŸ• â®ï¸ ğŸ“¨ ğŸ“¨ *ğŸ‘† ğŸ› ï¸*.

### â² â¡ ğŸ§¬

â² *â¡* ğŸ’ª âœ”ï¸ <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.2.md#key-expression" class="external-link" target="_blank">ğŸ—„ 3ï¸âƒ£ ğŸ§¬</a> ğŸ‘ˆ ğŸ’ª ğŸ”Œ ğŸ• â®ï¸ ğŸ“¨ ğŸ“¨ *ğŸ‘† ğŸ› ï¸*.

ğŸ‘‰ ğŸ’¼, âš«ï¸ `str`:

```Python
"{$callback_url}/invoices/{$request.body.id}"
```

, ğŸš¥ ğŸ‘† ğŸ› ï¸ ğŸ‘©â€ğŸ’» (ğŸ”¢ ğŸ‘©â€ğŸ’») ğŸ“¨ ğŸ“¨ *ğŸ‘† ğŸ› ï¸* :

```
https://yourapi.com/invoices/?callback_url=https://www.external.org/events
```

â®ï¸ ğŸ» ğŸ’ª:

```JSON
{
    "id": "2expen51ve",
    "customer": "Mr. Richie Rich",
    "total": "9999"
}
```

â¤´ï¸ *ğŸ‘† ğŸ› ï¸* ğŸ”œ ğŸ› ï¸ ğŸ§¾, &amp; â˜ âª, ğŸ“¨ â² ğŸ“¨ `callback_url` ( *ğŸ”¢ ğŸ› ï¸*):

```
https://www.external.org/events/invoices/2expen51ve
```

â®ï¸ ğŸ» ğŸ’ª âš— ğŸ•³ ğŸ’–:

```JSON
{
    "description": "Payment celebration",
    "paid": true
}
```

&amp; âš«ï¸ ğŸ”œ âŒ› ğŸ“¨ âšªï¸â¡ï¸ ğŸ‘ˆ *ğŸ”¢ ğŸ› ï¸* â®ï¸ ğŸ» ğŸ’ª ğŸ’–:

```JSON
{
    "ok": true
}
```

!!! tip
    ğŸ‘€ â” â² ğŸ“› âš™ï¸ ğŸ”Œ ğŸ“› ğŸ“¨ ğŸ”¢ ğŸ”¢ `callback_url` (`https://www.external.org/events`) &amp; ğŸ§¾ `id` âšªï¸â¡ï¸ ğŸ”˜ ğŸ» ğŸ’ª (`2expen51ve`).

### ğŸš® â² ğŸ“»

ğŸ‘‰ â˜ ğŸ‘† âœ”ï¸ *â² â¡ ğŸ› ï¸(â“‚)* ğŸ’ª (1ï¸âƒ£(â“‚) ğŸ‘ˆ *ğŸ”¢ ğŸ‘©â€ğŸ’»* ğŸ”œ ğŸ› ï¸ *ğŸ”¢ ğŸ› ï¸*) â² ğŸ“» ğŸ‘† âœ ğŸ”›.

ğŸ”œ âš™ï¸ ğŸ”¢ `callbacks` *ğŸ‘† ğŸ› ï¸ â¡ ğŸ› ï¸ ğŸ‘¨â€ğŸ¨* ğŸš¶â€â™€ï¸ ğŸ”¢ `.routes` (ğŸ‘ˆ ğŸ¤™ `list` ğŸ›£/*â¡ ğŸ› ï¸*) âšªï¸â¡ï¸ ğŸ‘ˆ â² ğŸ“»:

```Python hl_lines="35"
{!../../../docs_src/openapi_callbacks/tutorial001.py!}
```

!!! tip
    ğŸ‘€ ğŸ‘ˆ ğŸ‘† ğŸš« ğŸš¶â€â™€ï¸ ğŸ“» âš«ï¸ (`invoices_callback_router`) `callback=`, âœ‹ï¸ ğŸ”¢ `.routes`, `invoices_callback_router.routes`.

### âœ… ğŸ©º

ğŸ”œ ğŸ‘† ğŸ’ª â–¶ï¸ ğŸ‘† ğŸ“± â®ï¸ Uvicorn &amp; ğŸš¶ <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a>.

ğŸ‘† ğŸ”œ ğŸ‘€ ğŸ‘† ğŸ©º âœ… "â²" ğŸ“„ ğŸ‘† *â¡ ğŸ› ï¸* ğŸ‘ˆ ğŸ¦ â” *ğŸ”¢ ğŸ› ï¸* ğŸ”œ ğŸ‘€ ğŸ’–:

<img src="/img/tutorial/openapi-callbacks/image01.png">

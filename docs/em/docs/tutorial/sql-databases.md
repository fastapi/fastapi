# ğŸ—„ (ğŸ”—) ğŸ’½

**FastAPI** ğŸš« ğŸšš ğŸ‘† âš™ï¸ ğŸ—„ (ğŸ”—) ğŸ’½.

âœ‹ï¸ ğŸ‘† ğŸ’ª âš™ï¸ ğŸ™† ğŸ”— ğŸ’½ ğŸ‘ˆ ğŸ‘† ğŸ’š.

ğŸ“¥ ğŸ‘¥ ğŸ”œ ğŸ‘€ ğŸ–¼ âš™ï¸ <a href="https://www.sqlalchemy.org/" class="external-link" target="_blank">ğŸ‡¸ğŸ‡²</a>.

ğŸ‘† ğŸ’ª ğŸ’ª ğŸ› ï¸ âš«ï¸ ğŸ™† ğŸ’½ ğŸ•â€ğŸ¦º ğŸ‡¸ğŸ‡², ğŸ’–:

* âœ³
* âœ³
* ğŸ—„
* ğŸ¸
* ğŸ¤¸â€â™‚ ğŸ—„ ğŸ’½, â™’ï¸.

ğŸ‘‰ ğŸ–¼, ğŸ‘¥ ğŸ”œ âš™ï¸ **ğŸ—„**, â†©ï¸ âš«ï¸ âš™ï¸ ğŸ‘ ğŸ“ &amp; ğŸ âœ”ï¸ ğŸ› ï¸ ğŸ•â€ğŸ¦º. , ğŸ‘† ğŸ’ª ğŸ“ ğŸ‘‰ ğŸ–¼ &amp; ğŸƒ âš«ï¸.

âª, ğŸ‘† ğŸ­ ğŸˆ¸, ğŸ‘† ğŸ’ª ğŸ’š âš™ï¸ ğŸ’½ ğŸ’½ ğŸ’– **âœ³**.

!!! tip
    ğŸ“¤ ğŸ›‚ ğŸ— ğŸš‚ â®ï¸ **FastAPI** &amp; **âœ³**, ğŸŒ âš“ï¸ ğŸ”› **â˜**, ğŸ”Œ ğŸ•¸ &amp; ğŸŒ– ğŸ§°: <a href="https://github.com/tiangolo/full-stack-fastapi-postgresql" class="external-link" target="_blank">https://github.com/tiangolo/full-stack-fastapi-postgresql</a>

!!! note
    ğŸ‘€ ğŸ‘ˆ ğŸ“š ğŸ“Ÿ ğŸ© `SQLAlchemy` ğŸ“Ÿ ğŸ‘† ğŸ”œ âš™ï¸ â®ï¸ ğŸ™† ğŸ› ï¸.

     **FastAPI** ğŸ¯ ğŸ“Ÿ ğŸ¤ª ğŸ•§.

## ğŸœ

**FastAPI** ğŸ‘· â®ï¸ ğŸ™† ğŸ’½ &amp; ğŸ™† ğŸ‘— ğŸ—ƒ ğŸ’¬ ğŸ’½.

âš  âš“ âš™ï¸ "ğŸœ": "ğŸš-ğŸ”— ğŸ—º" ğŸ—ƒ.

ğŸœ âœ”ï¸ ğŸ§° ğŸ—œ ("*ğŸ—º*") ğŸ–– *ğŸš* ğŸ“Ÿ &amp; ğŸ’½ ğŸ“ ("*ğŸ”—*").

â®ï¸ ğŸœ, ğŸ‘† ğŸ› âœ ğŸ“ ğŸ‘ˆ ğŸ¨ ğŸ“ ğŸ—„ ğŸ’½, ğŸ”  ğŸ”¢ ğŸ“ ğŸ¨ ğŸ“, â®ï¸ ğŸ“› &amp; ğŸ†.

ğŸ–¼ ğŸ“ `Pet` ğŸ’ª ğŸ¨ ğŸ—„ ğŸ“ `pets`.

&amp; ğŸ”  *ğŸ‘* ğŸš ğŸ‘ˆ ğŸ“ ğŸ¨ â­ ğŸ’½.

ğŸ–¼ ğŸš `orion_cat` (ğŸ‘ `Pet`) ğŸ’ª âœ”ï¸ ğŸ”¢ `orion_cat.type`, ğŸ“ `type`. &amp; ğŸ’² ğŸ‘ˆ ğŸ”¢ ğŸ’ª, âœ… `"cat"`.

ğŸ‘« ğŸœ âœ”ï¸ ğŸ§° âš’ ğŸ”— âš–ï¸ ğŸ”— ğŸ–– ğŸ“ âš–ï¸ ğŸ‘¨â€ğŸ’¼.

ğŸ‘‰ ğŸŒŒ, ğŸ‘† ğŸ’ª âœ”ï¸ ğŸ”¢ `orion_cat.owner` &amp; ğŸ‘¨â€ğŸ’¼ ğŸ”œ ğŸ”Œ ğŸ’½ ğŸ‘‰ ğŸ¶ ğŸ‘¨â€ğŸ’¼, âœŠ âšªï¸â¡ï¸ ğŸ“ *ğŸ‘¨â€ğŸ’¼*.

, `orion_cat.owner.name` ğŸ’ª ğŸ“› (âšªï¸â¡ï¸ `name` ğŸ“ `owners` ğŸ“) ğŸ‘‰ ğŸ¶ ğŸ‘¨â€ğŸ’¼.

âš«ï¸ ğŸ’ª âœ”ï¸ ğŸ’² ğŸ’– `"Arquilian"`.

&amp; ğŸœ ğŸ”œ ğŸŒ ğŸ‘· ğŸ¤š â„¹ âšªï¸â¡ï¸ ğŸ”— ğŸ“ *ğŸ‘¨â€ğŸ’¼* ğŸ•â” ğŸ‘† ğŸ”„ ğŸ” âš«ï¸ âšªï¸â¡ï¸ ğŸ‘† ğŸ¶ ğŸš.

âš  ğŸœ ğŸ–¼: âœ³-ğŸœ (ğŸ• âœ³ ğŸ› ï¸), ğŸ‡¸ğŸ‡² ğŸœ (ğŸ• ğŸ‡¸ğŸ‡², ğŸ”¬ ğŸ› ï¸) &amp; ğŸ’ (ğŸ”¬ ğŸ› ï¸), ğŸ‘ª ğŸ.

ğŸ“¥ ğŸ‘¥ ğŸ”œ ğŸ‘€ â” ğŸ‘· â®ï¸ **ğŸ‡¸ğŸ‡² ğŸœ**.

ğŸ ğŸŒŒ ğŸ‘† ğŸ’ª âš™ï¸ ğŸ™† ğŸ ğŸœ.

!!! tip
    ğŸ“¤ ğŸŒ“ ğŸ“„ âš™ï¸ ğŸ’ ğŸ“¥ ğŸ©º.

## ğŸ“ ğŸ“Š

ğŸ‘« ğŸ–¼, â¡ï¸ ğŸ’¬ ğŸ‘† âœ”ï¸ ğŸ“ ğŸ“› `my_super_project` ğŸ‘ˆ ğŸ”Œ ğŸ§-ğŸ“ ğŸ¤™ `sql_app` â®ï¸ ğŸ“Š ğŸ’– ğŸ‘‰:

```
.
â””â”€â”€ sql_app
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ crud.py
    â”œâ”€â”€ database.py
    â”œâ”€â”€ main.py
    â”œâ”€â”€ models.py
    â””â”€â”€ schemas.py
```

ğŸ“ `__init__.py` ğŸ› ğŸ“, âœ‹ï¸ âš«ï¸ ğŸ’¬ ğŸ ğŸ‘ˆ `sql_app` â®ï¸ ğŸŒ ğŸš® ğŸ•¹ (ğŸ ğŸ“) ğŸ“¦.

ğŸ”œ â¡ï¸ ğŸ‘€ âš«ï¸â” ğŸ”  ğŸ“/ğŸ•¹ ğŸ”¨.

## â `SQLAlchemy`

ğŸ¥‡ ğŸ‘† ğŸ’ª â `SQLAlchemy`:

<div class="termy">

```console
$ pip install sqlalchemy

---> 100%
```

</div>

## âœ ğŸ‡¸ğŸ‡² ğŸ•

â¡ï¸ ğŸ”— ğŸ“ `sql_app/database.py`.

### ğŸ—„ ğŸ‡¸ğŸ‡² ğŸ•

```Python hl_lines="1-3"
{!../../../docs_src/sql_databases/sql_app/database.py!}
```

### âœ ğŸ’½ ğŸ“› ğŸ‡¸ğŸ‡²

```Python hl_lines="5-6"
{!../../../docs_src/sql_databases/sql_app/database.py!}
```

ğŸ‘‰ ğŸ–¼, ğŸ‘¥ "ğŸ”—" ğŸ—„ ğŸ’½ (ğŸ“‚ ğŸ“ â®ï¸ ğŸ—„ ğŸ’½).

ğŸ“ ğŸ”œ ğŸ” ğŸ ğŸ“ ğŸ“ `sql_app.db`.

ğŸ‘ˆ âš«ï¸â” ğŸ ğŸ• `./sql_app.db`.

ğŸš¥ ğŸ‘† âš™ï¸ **âœ³** ğŸ’½ â†©ï¸, ğŸ‘† ğŸ”œ âœ”ï¸ âœ â¸:

```Python
SQLALCHEMY_DATABASE_URL = "postgresql://user:password@postgresserver/db"
```

...&amp; ğŸ› ï¸ âš«ï¸ â®ï¸ ğŸ‘† ğŸ’½ ğŸ“Š &amp; ğŸ“ (ğŸ“Š âœ³, âœ³ âš–ï¸ ğŸ™† ğŸ).

!!! tip

    ğŸ‘‰ ğŸ‘‘ â¸ ğŸ‘ˆ ğŸ‘† ğŸ”œ âœ”ï¸ ğŸ”€ ğŸš¥ ğŸ‘† ğŸ’š âš™ï¸ ğŸ ğŸ’½.

### âœ ğŸ‡¸ğŸ‡² `engine`

ğŸ¥‡ ğŸ” âœ ğŸ‡¸ğŸ‡² "ğŸš’".

ğŸ‘¥ ğŸ”œ âª âš™ï¸ ğŸ‘‰ `engine` ğŸ ğŸ¥‰.

```Python hl_lines="8-10"
{!../../../docs_src/sql_databases/sql_app/database.py!}
```

#### ğŸ—’

âŒ:

```Python
connect_args={"check_same_thread": False}
```

...ğŸ’ª ğŸ•´ `SQLite`. âš«ï¸ ğŸš« ğŸ’ª ğŸ ğŸ’½.

!!! info "ğŸ“¡ â„¹"

    ğŸ”¢ ğŸ—„ ğŸ”œ ğŸ•´ âœ” 1ï¸âƒ£ ğŸ§µ ğŸ”— â®ï¸ âš«ï¸, ğŸ¤” ğŸ‘ˆ ğŸ”  ğŸ§µ ğŸ”œ ğŸµ ğŸ”¬ ğŸ“¨.

    ğŸ‘‰ â ğŸ˜« ğŸ¤ ğŸ ğŸ”— ğŸ ğŸ‘œ (ğŸ ğŸ“¨).

    âœ‹ï¸ FastAPI, âš™ï¸ ğŸ˜ ğŸ”¢ (`def`) ğŸŒ… ğŸŒ˜ 1ï¸âƒ£ ğŸ§µ ğŸ’ª ğŸ”— â®ï¸ ğŸ’½ ğŸ ğŸ“¨, ğŸ‘¥ ğŸ’ª âš’ ğŸ—„ ğŸ’­ ğŸ‘ˆ âš«ï¸ ğŸ”œ âœ” ğŸ‘ˆ â®ï¸ `connect_args={"check_same_thread": False}`.

    , ğŸ‘¥ ğŸ”œ âš’ ğŸ’­ ğŸ”  ğŸ“¨ ğŸ¤š ğŸš® ğŸ‘ ğŸ’½ ğŸ”— ğŸ‰ ğŸ”—, ğŸ“¤ ğŸ™…â€â™‚ ğŸ’ª ğŸ‘ˆ ğŸ”¢ ğŸ› ï¸.

### âœ `SessionLocal` ğŸ“

ğŸ”  ğŸ‘ `SessionLocal` ğŸ“ ğŸ”œ ğŸ’½ ğŸ‰. ğŸ“ âš«ï¸ ğŸš« ğŸ’½ ğŸ‰.

âœ‹ï¸ ğŸ• ğŸ‘¥ âœ ğŸ‘ `SessionLocal` ğŸ“, ğŸ‘‰ ğŸ‘ ğŸ”œ â˜‘ ğŸ’½ ğŸ‰.

ğŸ‘¥ ğŸ“› âš«ï¸ `SessionLocal` ğŸ”¬ âš«ï¸ âšªï¸â¡ï¸ `Session` ğŸ‘¥ ğŸ­ âšªï¸â¡ï¸ ğŸ‡¸ğŸ‡².

ğŸ‘¥ ğŸ”œ âš™ï¸ `Session` (1ï¸âƒ£ ğŸ—„ âšªï¸â¡ï¸ ğŸ‡¸ğŸ‡²) âª.

âœ `SessionLocal` ğŸ“, âš™ï¸ ğŸ”¢ `sessionmaker`:

```Python hl_lines="11"
{!../../../docs_src/sql_databases/sql_app/database.py!}
```

### âœ `Base` ğŸ“

ğŸ”œ ğŸ‘¥ ğŸ”œ âš™ï¸ ğŸ”¢ `declarative_base()` ğŸ‘ˆ ğŸ“¨ ğŸ“.

âª ğŸ‘¥ ğŸ”œ ğŸ˜– âšªï¸â¡ï¸ ğŸ‘‰ ğŸ“ âœ ğŸ”  ğŸ’½ ğŸ· âš–ï¸ ğŸ“ (ğŸœ ğŸ·):

```Python hl_lines="13"
{!../../../docs_src/sql_databases/sql_app/database.py!}
```

## âœ ğŸ’½ ğŸ·

â¡ï¸ ğŸ”œ ğŸ‘€ ğŸ“ `sql_app/models.py`.

### âœ ğŸ‡¸ğŸ‡² ğŸ· âšªï¸â¡ï¸ `Base` ğŸ“

ğŸ‘¥ ğŸ”œ âš™ï¸ ğŸ‘‰ `Base` ğŸ“ ğŸ‘¥ âœ â­ âœ ğŸ‡¸ğŸ‡² ğŸ·.

!!! tip
    ğŸ‡¸ğŸ‡² âš™ï¸ âš– "**ğŸ·**" ğŸ”— ğŸ‘‰ ğŸ“ &amp; ğŸ‘ ğŸ‘ˆ ğŸ”— â®ï¸ ğŸ’½.

    âœ‹ï¸ Pydantic âš™ï¸ âš– "**ğŸ·**" ğŸ”— ğŸ•³ ğŸ, ğŸ’½ ğŸ”¬, ğŸ› ï¸, &amp; ğŸ§¾ ğŸ“ &amp; ğŸ‘.

ğŸ—„ `Base` âšªï¸â¡ï¸ `database` (ğŸ“ `database.py` âšªï¸â¡ï¸ ğŸ”›).

âœ ğŸ“ ğŸ‘ˆ ğŸ˜– âšªï¸â¡ï¸ âš«ï¸.

ğŸ‘« ğŸ“ ğŸ‡¸ğŸ‡² ğŸ·.

```Python hl_lines="4  7-8  18-19"
{!../../../docs_src/sql_databases/sql_app/models.py!}
```

`__tablename__` ğŸ”¢ ğŸ’¬ ğŸ‡¸ğŸ‡² ğŸ“› ğŸ“ âš™ï¸ ğŸ’½ ğŸ”  ğŸ‘« ğŸ·.

### âœ ğŸ· ğŸ”¢/ğŸ“

ğŸ”œ âœ ğŸŒ ğŸ· (ğŸ“) ğŸ”¢.

ğŸ”  ğŸ‘« ğŸ”¢ ğŸ¨ ğŸ“ ğŸš® ğŸ”— ğŸ’½ ğŸ“.

ğŸ‘¥ âš™ï¸ `Column` âšªï¸â¡ï¸ ğŸ‡¸ğŸ‡² ğŸ”¢ ğŸ’².

&amp; ğŸ‘¥ ğŸš¶â€â™€ï¸ ğŸ‡¸ğŸ‡² ğŸ“ "ğŸ†", `Integer`, `String`, &amp; `Boolean`, ğŸ‘ˆ ğŸ”¬ ğŸ† ğŸ’½, âŒ.

```Python hl_lines="1  10-13  21-24"
{!../../../docs_src/sql_databases/sql_app/models.py!}
```

### âœ ğŸ’›

ğŸ”œ âœ ğŸ’›.

ğŸ‘‰, ğŸ‘¥ âš™ï¸ `relationship` ğŸšš ğŸ‡¸ğŸ‡² ğŸœ.

ğŸ‘‰ ğŸ”œ â–¶ï¸ï¸, ğŸŒ… âš–ï¸ ğŸŒ˜, "ğŸ±" ğŸ”¢ ğŸ‘ˆ ğŸ”œ ğŸ”Œ ğŸ’² âšªï¸â¡ï¸ ğŸ ğŸ“ ğŸ”— ğŸ‘‰ 1ï¸âƒ£.

```Python hl_lines="2  15  26"
{!../../../docs_src/sql_databases/sql_app/models.py!}
```

ğŸ•â” ğŸ” ğŸ”¢ `items` `User`, `my_user.items`, âš«ï¸ ğŸ”œ âœ”ï¸ ğŸ“‡ `Item` ğŸ‡¸ğŸ‡² ğŸ· (âšªï¸â¡ï¸ `items` ğŸ“) ğŸ‘ˆ âœ”ï¸ ğŸ’± ğŸ”‘ â˜ ğŸ‘‰ âº `users` ğŸ“.

ğŸ•â” ğŸ‘† ğŸ” `my_user.items`, ğŸ‡¸ğŸ‡² ğŸ”œ ğŸ¤™ ğŸš¶ &amp; â˜• ğŸ¬ âšªï¸â¡ï¸ ğŸ’½ `items` ğŸ“ &amp; ğŸ”— ğŸ‘« ğŸ“¥.

&amp; ğŸ•â” ğŸ” ğŸ”¢ `owner` `Item`, âš«ï¸ ğŸ”œ ğŸ”Œ `User` ğŸ‡¸ğŸ‡² ğŸ· âšªï¸â¡ï¸ `users` ğŸ“. âš«ï¸ ğŸ”œ âš™ï¸ `owner_id` ğŸ”¢/ğŸ“ â®ï¸ ğŸš® ğŸ’± ğŸ”‘ ğŸ’­ â” âº ğŸ¤š âšªï¸â¡ï¸ `users` ğŸ“.

## âœ Pydantic ğŸ·

ğŸ”œ â¡ï¸ âœ… ğŸ“ `sql_app/schemas.py`.

!!! tip
    â ğŸ˜¨ ğŸ–– ğŸ‡¸ğŸ‡² *ğŸ·* &amp; Pydantic *ğŸ·*, ğŸ‘¥ ğŸ”œ âœ”ï¸ ğŸ“ `models.py` â®ï¸ ğŸ‡¸ğŸ‡² ğŸ·, &amp; ğŸ“ `schemas.py` â®ï¸ Pydantic ğŸ·.

    ğŸ‘« Pydantic ğŸ· ğŸ”¬ ğŸŒ… âš–ï¸ ğŸŒ˜ "ğŸ”—" (â˜‘ ğŸ“Š ğŸ’ ).

    ğŸ‘‰ ğŸ”œ â„¹ ğŸ‘¥ â ğŸ˜¨ âª âš™ï¸ ğŸ‘¯â€â™‚ï¸.

### âœ â–¶ï¸ Pydantic *ğŸ·* / ğŸ”—

âœ `ItemBase` &amp; `UserBase` Pydantic *ğŸ·* (âš–ï¸ â¡ï¸ ğŸ’¬ "ğŸ”—") âœ”ï¸ âš  ğŸ”¢ âª ğŸ— âš–ï¸ ğŸ‘‚ ğŸ“Š.

&amp; âœ `ItemCreate` &amp; `UserCreate` ğŸ‘ˆ ğŸ˜– âšªï¸â¡ï¸ ğŸ‘« (ğŸ‘« ğŸ”œ âœ”ï¸ ğŸ ğŸ”¢), â• ğŸ™† ğŸŒ– ğŸ“Š (ğŸ”¢) ğŸ’ª ğŸ—.

, ğŸ‘©â€ğŸ’» ğŸ”œ âœ”ï¸ `password` ğŸ•â” ğŸ— âš«ï¸.

âœ‹ï¸ ğŸ’‚â€â™‚, `password` ğŸ† ğŸš« ğŸ Pydantic *ğŸ·*, ğŸ–¼, âš«ï¸ ğŸ† ğŸš« ğŸ“¨ âšªï¸â¡ï¸ ğŸ› ï¸ ğŸ•â” ğŸ‘‚ ğŸ‘©â€ğŸ’».

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="3  6-8  11-12  23-24  27-28"
    {!> ../../../docs_src/sql_databases/sql_app/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="3  6-8  11-12  23-24  27-28"
    {!> ../../../docs_src/sql_databases/sql_app_py39/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.1ï¸âƒ£0ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="1  4-6  9-10  21-22  25-26"
    {!> ../../../docs_src/sql_databases/sql_app_py310/schemas.py!}
    ```

#### ğŸ‡¸ğŸ‡² ğŸ‘— &amp; Pydantic ğŸ‘—

ğŸ‘€ ğŸ‘ˆ ğŸ‡¸ğŸ‡² *ğŸ·* ğŸ”¬ ğŸ”¢ âš™ï¸ `=`, &amp; ğŸš¶â€â™€ï¸ ğŸ† ğŸ”¢ `Column`, ğŸ’–:

```Python
name = Column(String)
```

âª Pydantic *ğŸ·* ğŸ“£ ğŸ† âš™ï¸ `:`, ğŸ†• ğŸ† âœ â•/ğŸ† ğŸ”‘:

```Python
name: str
```

âœ”ï¸ âš«ï¸ ğŸ¤¯, ğŸ‘† ğŸš« ğŸ¤š ğŸ˜• ğŸ•â” âš™ï¸ `=` &amp; `:` â®ï¸ ğŸ‘«.

### âœ Pydantic *ğŸ·* / ğŸ”— ğŸ‘‚ / ğŸ“¨

ğŸ”œ âœ Pydantic *ğŸ·* (ğŸ”—) ğŸ‘ˆ ğŸ”œ âš™ï¸ ğŸ•â” ğŸ‘‚ ğŸ’½, ğŸ•â” ğŸ›¬ âš«ï¸ âšªï¸â¡ï¸ ğŸ› ï¸.

ğŸ–¼, â­ ğŸ— ğŸ¬, ğŸ‘¥ ğŸš« ğŸ’­ âš«ï¸â” ğŸ”œ ğŸ†” ğŸ› ï¸ âš«ï¸, âœ‹ï¸ ğŸ•â” ğŸ‘‚ âš«ï¸ (ğŸ•â” ğŸ›¬ âš«ï¸ âšªï¸â¡ï¸ ğŸ› ï¸) ğŸ‘¥ ğŸ”œ âª ğŸ’­ ğŸš® ğŸ†”.

ğŸ ğŸŒŒ, ğŸ•â” ğŸ‘‚ ğŸ‘©â€ğŸ’», ğŸ‘¥ ğŸ’ª ğŸ”œ ğŸ“£ ğŸ‘ˆ `items` ğŸ”œ ğŸ”Œ ğŸ¬ ğŸ‘ˆ ğŸ’­ ğŸ‘‰ ğŸ‘©â€ğŸ’».

ğŸš« ğŸ•´ ğŸ†” ğŸ“š ğŸ¬, âœ‹ï¸ ğŸŒ ğŸ’½ ğŸ‘ˆ ğŸ‘¥ ğŸ”¬ Pydantic *ğŸ·* ğŸ‘‚ ğŸ¬: `Item`.

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="15-17  31-34"
    {!> ../../../docs_src/sql_databases/sql_app/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="15-17  31-34"
    {!> ../../../docs_src/sql_databases/sql_app_py39/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.1ï¸âƒ£0ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="13-15  29-32"
    {!> ../../../docs_src/sql_databases/sql_app_py310/schemas.py!}
    ```

!!! tip
    ğŸ‘€ ğŸ‘ˆ `User`, Pydantic *ğŸ·* ğŸ‘ˆ ğŸ”œ âš™ï¸ ğŸ•â” ğŸ‘‚ ğŸ‘©â€ğŸ’» (ğŸ›¬ âš«ï¸ âšªï¸â¡ï¸ ğŸ› ï¸) ğŸš« ğŸ”Œ `password`.

### âš™ï¸ Pydantic `orm_mode`

ğŸ”œ, Pydantic *ğŸ·* ğŸ‘‚, `Item` &amp; `User`, ğŸš® ğŸ”— `Config` ğŸ“.

ğŸ‘‰ <a href="https://pydantic-docs.helpmanual.io/usage/model_config/" class="external-link" target="_blank">`Config`</a> ğŸ“ âš™ï¸ ğŸšš ğŸ“³ Pydantic.

`Config` ğŸ“, âš’ ğŸ”¢ `orm_mode = True`.

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="15  19-20  31  36-37"
    {!> ../../../docs_src/sql_databases/sql_app/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="15  19-20  31  36-37"
    {!> ../../../docs_src/sql_databases/sql_app_py39/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.1ï¸âƒ£0ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="13  17-18  29  34-35"
    {!> ../../../docs_src/sql_databases/sql_app_py310/schemas.py!}
    ```

!!! tip
    ğŸ‘€ âš«ï¸ âš– ğŸ’² â®ï¸ `=`, ğŸ’–:

    `orm_mode = True`

    âš«ï¸ ğŸš« âš™ï¸ `:` ğŸ† ğŸ“„ â­.

    ğŸ‘‰ âš’ ğŸ“ ğŸ’², ğŸš« ğŸ“£ ğŸ†.

Pydantic `orm_mode` ğŸ”œ ğŸ’¬ Pydantic *ğŸ·* âœ ğŸ’½ ğŸš¥ âš«ï¸ ğŸš« `dict`, âœ‹ï¸ ğŸœ ğŸ· (âš–ï¸ ğŸ™† ğŸ âŒ ğŸš â®ï¸ ğŸ”¢).

ğŸ‘‰ ğŸŒŒ, â†©ï¸ ğŸ•´ ğŸ”„ ğŸ¤š `id` ğŸ’² âšªï¸â¡ï¸ `dict`,:

```Python
id = data["id"]
```

âš«ï¸ ğŸ”œ ğŸ”„ ğŸ¤š âš«ï¸ âšªï¸â¡ï¸ ğŸ”¢,:

```Python
id = data.id
```

&amp; â®ï¸ ğŸ‘‰, Pydantic *ğŸ·* ğŸ”— â®ï¸ ğŸœ, &amp; ğŸ‘† ğŸ’ª ğŸ“£ âš«ï¸ `response_model` âŒ ğŸ‘† *â¡ ğŸ› ï¸*.

ğŸ‘† ğŸ”œ ğŸ’ª ğŸ“¨ ğŸ’½ ğŸ· &amp; âš«ï¸ ğŸ”œ âœ ğŸ’½ âšªï¸â¡ï¸ âš«ï¸.

#### ğŸ“¡ â„¹ ğŸ”ƒ ğŸœ ğŸ“³

ğŸ‡¸ğŸ‡² &amp; ğŸ“š ğŸ ğŸ”¢ "ğŸ™ƒ ğŸšš".

ğŸ‘ˆ â›“, ğŸ–¼, ğŸ‘ˆ ğŸ‘« ğŸš« â˜• ğŸ’½ ğŸ’› âšªï¸â¡ï¸ ğŸ’½ ğŸš¥ ğŸ‘† ğŸ”„ ğŸ” ğŸ”¢ ğŸ‘ˆ ğŸ”œ ğŸ”Œ ğŸ‘ˆ ğŸ’½.

ğŸ–¼, ğŸ” ğŸ”¢ `items`:

```Python
current_user.items
```

ğŸ”œ âš’ ğŸ‡¸ğŸ‡² ğŸš¶ `items` ğŸ“ &amp; ğŸ¤š ğŸ¬ ğŸ‘‰ ğŸ‘©â€ğŸ’», âœ‹ï¸ ğŸš« â­.

ğŸµ `orm_mode`, ğŸš¥ ğŸ‘† ğŸ“¨ ğŸ‡¸ğŸ‡² ğŸ· âšªï¸â¡ï¸ ğŸ‘† *â¡ ğŸ› ï¸*, âš«ï¸ ğŸš«ğŸ”œ ğŸ”Œ ğŸ’› ğŸ’½.

ğŸš¥ ğŸ‘† ğŸ“£ ğŸ“š ğŸ’› ğŸ‘† Pydantic ğŸ·.

âœ‹ï¸ â®ï¸ ğŸœ ğŸ“³, Pydantic âš«ï¸ ğŸ”œ ğŸ”„ ğŸ” ğŸ’½ âš«ï¸ ğŸ’ª âšªï¸â¡ï¸ ğŸ”¢ (â†©ï¸ ğŸ¤” `dict`), ğŸ‘† ğŸ’ª ğŸ“£ ğŸ¯ ğŸ’½ ğŸ‘† ğŸ’š ğŸ“¨ &amp; âš«ï¸ ğŸ”œ ğŸ’ª ğŸš¶ &amp; ğŸ¤š âš«ï¸, âšªï¸â¡ï¸ ğŸœ.

## ğŸ’© ğŸ‡¨ğŸ‡»

ğŸ”œ â¡ï¸ ğŸ‘€ ğŸ“ `sql_app/crud.py`.

ğŸ‘‰ ğŸ“ ğŸ‘¥ ğŸ”œ âœ”ï¸ â™» ğŸ”¢ ğŸ”— â®ï¸ ğŸ’½ ğŸ’½.

**ğŸ’©** ğŸ‘Ÿ âšªï¸â¡ï¸: **ğŸ…±**ğŸ“§, **â“‚**ğŸ’³, **ğŸ‘¤** = , &amp; **ğŸ‡¨ğŸ‡®**ğŸ“§.

...ğŸ‘ ğŸ‘‰ ğŸ–¼ ğŸ‘¥ ğŸ•´ ğŸ— &amp; ğŸ‘‚.

### âœ ğŸ’½

ğŸ—„ `Session` âšªï¸â¡ï¸ `sqlalchemy.orm`, ğŸ‘‰ ğŸ”œ âœ” ğŸ‘† ğŸ“£ ğŸ† `db` ğŸ”¢ &amp; âœ”ï¸ ğŸ‘» ğŸ† âœ… &amp; ğŸ› ï¸ ğŸ‘† ğŸ”¢.

ğŸ—„ `models` (ğŸ‡¸ğŸ‡² ğŸ·) &amp; `schemas` (Pydantic *ğŸ·* / ğŸ”—).

âœ ğŸš™ ğŸ”¢:

* âœ ğŸ‘ ğŸ‘©â€ğŸ’» ğŸ†” &amp; ğŸ“§.
* âœ ğŸ’— ğŸ‘©â€ğŸ’».
* âœ ğŸ’— ğŸ¬.

```Python hl_lines="1  3  6-7  10-11  14-15  27-28"
{!../../../docs_src/sql_databases/sql_app/crud.py!}
```

!!! tip
    ğŸ— ğŸ”¢ ğŸ‘ˆ ğŸ•´ ğŸ’¡ ğŸ”— â®ï¸ ğŸ’½ (ğŸ¤š ğŸ‘©â€ğŸ’» âš–ï¸ ğŸ¬) ğŸ”¬ ğŸ‘† *â¡ ğŸ› ï¸ ğŸ”¢*, ğŸ‘† ğŸ’ª ğŸŒ– ğŸ’ª â™» ğŸ‘« ğŸ’— ğŸ• &amp; ğŸš® <abbr title="Automated tests, written in code, that check if another piece of code is working correctly.">âš’ ğŸ’¯</abbr> ğŸ‘«.

### âœ ğŸ’½

ğŸ”œ âœ ğŸš™ ğŸ”¢ âœ ğŸ’½.

ğŸ”:

* âœ ğŸ‡¸ğŸ‡² ğŸ· *ğŸ‘* â®ï¸ ğŸ‘† ğŸ“Š.
* `add` ğŸ‘ˆ ğŸ‘ ğŸš ğŸ‘† ğŸ’½ ğŸ‰.
* `commit` ğŸ”€ ğŸ’½ (ğŸ‘ˆ ğŸ‘« ğŸ–Š).
* `refresh` ğŸ‘† ğŸ‘ (ğŸ‘ˆ âš«ï¸ ğŸ”Œ ğŸ™† ğŸ†• ğŸ“Š âšªï¸â¡ï¸ ğŸ’½, ğŸ’– ğŸ— ğŸ†”).

```Python hl_lines="18-24  31-36"
{!../../../docs_src/sql_databases/sql_app/crud.py!}
```

!!! tip
    ğŸ‡¸ğŸ‡² ğŸ· `User` ğŸ”Œ `hashed_password` ğŸ‘ˆ ğŸ”œ ğŸ”Œ ğŸ” #ï¸âƒ£ â¬ ğŸ”.

    âœ‹ï¸ âš«ï¸â” ğŸ› ï¸ ğŸ‘©â€ğŸ’» ğŸšš â®ï¸ ğŸ”, ğŸ‘† ğŸ’ª âš— âš«ï¸ &amp; ğŸ— #ï¸âƒ£ ğŸ” ğŸ‘† ğŸˆ¸.

     &amp; â¤´ï¸ ğŸš¶â€â™€ï¸ `hashed_password` âŒ â®ï¸ ğŸ’² ğŸ–Š.

!!! warning
    ğŸ‘‰ ğŸ–¼ ğŸš« ğŸ”, ğŸ” ğŸš«#ï¸âƒ£.

    ğŸ° ğŸ‘¨â€â¤â€ğŸ‘¨ ğŸˆ¸ ğŸ‘† ğŸ”œ ğŸ’ª #ï¸âƒ£ ğŸ” &amp; ğŸ™… ğŸ–Š ğŸ‘« ğŸ”¢.

    ğŸŒ… â„¹, ğŸš¶ ğŸ”™ ğŸ’‚â€â™‚ ğŸ“„ ğŸ”°.

    ğŸ“¥ ğŸ‘¥ ğŸ¯ ğŸ•´ ğŸ”› ğŸ§° &amp; ğŸ‘¨â€ğŸ”§ ğŸ’½.

!!! tip
    â†©ï¸ ğŸš¶â€â™€ï¸ ğŸ”  ğŸ‡¨ğŸ‡» âŒ `Item` &amp; ğŸ‘‚ ğŸ”  1ï¸âƒ£ ğŸ‘« âšªï¸â¡ï¸ Pydantic *ğŸ·*, ğŸ‘¥ ğŸ­ `dict` â®ï¸ Pydantic *ğŸ·*'â“‚ ğŸ“Š â®ï¸:

    `item.dict()`

     &amp; â¤´ï¸ ğŸ‘¥ ğŸš¶â€â™€ï¸ `dict`'â“‚ ğŸ”‘-ğŸ’² ğŸ‘« ğŸ‡¨ğŸ‡» âŒ ğŸ‡¸ğŸ‡² `Item`, â®ï¸:

    `Item(**item.dict())`

     &amp; â¤´ï¸ ğŸ‘¥ ğŸš¶â€â™€ï¸ â• ğŸ‡¨ğŸ‡» âŒ `owner_id` ğŸ‘ˆ ğŸš« ğŸšš Pydantic *ğŸ·*, â®ï¸:

    `Item(**item.dict(), owner_id=user_id)`

## ğŸ‘‘ **FastAPI** ğŸ“±

&amp; ğŸ”œ ğŸ“ `sql_app/main.py` â¡ï¸ ğŸ› ï¸ &amp; âš™ï¸ ğŸŒ ğŸ ğŸ• ğŸ‘¥ âœ â­.

### âœ ğŸ’½ ğŸ“

ğŸ“¶ ğŸ™ƒ ğŸŒŒ âœ ğŸ’½ ğŸ“:

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="9"
    {!> ../../../docs_src/sql_databases/sql_app/main.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="7"
    {!> ../../../docs_src/sql_databases/sql_app_py39/main.py!}
    ```

#### âš— ğŸ—’

ğŸ› ğŸ‘† ğŸ”œ ğŸ² ğŸ”¢ ğŸ‘† ğŸ’½ (âœ ğŸ“, â™’ï¸) â®ï¸ <a href="https://alembic.sqlalchemy.org/en/latest/" class="external-link" target="_blank">âš—</a>.

&amp; ğŸ‘† ğŸ”œ âš™ï¸ âš— "ğŸ› ï¸" (ğŸ‘ˆ ğŸš® ğŸ‘‘ ğŸ‘¨â€ğŸ­).

"ğŸ› ï¸" âš’ ğŸ” ğŸ’ª ğŸ•â” ğŸ‘† ğŸ”€ ğŸ“Š ğŸ‘† ğŸ‡¸ğŸ‡² ğŸ·, ğŸš® ğŸ†• ğŸ”¢, â™’ï¸. ğŸ” ğŸ‘ˆ ğŸ”€ ğŸ’½, ğŸš® ğŸ†• ğŸ“, ğŸ†• ğŸ“, â™’ï¸.

ğŸ‘† ğŸ’ª ğŸ” ğŸ–¼ âš— FastAPI ğŸ— ğŸ“„ âšªï¸â¡ï¸ [ğŸ— âš¡ - ğŸ“„](../project-generation.md){.internal-link target=_blank}. ğŸ¯ <a href="https://github.com/tiangolo/full-stack-fastapi-postgresql/tree/master/%7B%7Bcookiecutter.project_slug%7D%7D/backend/app/alembic/" class="external-link" target="_blank"> `alembic` ğŸ“ â„¹ ğŸ“Ÿ</a>.

### âœ ğŸ”—

ğŸ”œ âš™ï¸ `SessionLocal` ğŸ“ ğŸ‘¥ âœ `sql_app/database.py` ğŸ“ âœ ğŸ”—.

ğŸ‘¥ ğŸ’ª âœ”ï¸ ğŸ”¬ ğŸ’½ ğŸ‰/ğŸ”— (`SessionLocal`) ğŸ“ ğŸ“¨, âš™ï¸ ğŸ ğŸ‰ ğŸ”˜ ğŸŒ ğŸ“¨ &amp; â¤´ï¸ ğŸ” âš«ï¸ â®ï¸ ğŸ“¨ ğŸ.

&amp; â¤´ï¸ ğŸ†• ğŸ‰ ğŸ”œ âœ â­ ğŸ“¨.

ğŸ‘ˆ, ğŸ‘¥ ğŸ”œ âœ ğŸ†• ğŸ”— â®ï¸ `yield`, ğŸ”¬ â­ ğŸ“„ ğŸ”ƒ [ğŸ”— â®ï¸ `yield`](dependencies/dependencies-with-yield.md){.internal-link target=_blank}.

ğŸ‘† ğŸ”— ğŸ”œ âœ ğŸ†• ğŸ‡¸ğŸ‡² `SessionLocal` ğŸ‘ˆ ğŸ”œ âš™ï¸ ğŸ‘ ğŸ“¨, &amp; â¤´ï¸ ğŸ” âš«ï¸ ğŸ• ğŸ“¨ ğŸ.

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="15-20"
    {!> ../../../docs_src/sql_databases/sql_app/main.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="13-18"
    {!> ../../../docs_src/sql_databases/sql_app_py39/main.py!}
    ```

!!! info
    ğŸ‘¥ ğŸš® ğŸ— `SessionLocal()` &amp; ğŸšš ğŸ“¨ `try` ğŸ«.

     &amp; â¤´ï¸ ğŸ‘¥ ğŸ” âš«ï¸ `finally` ğŸ«.

    ğŸ‘‰ ğŸŒŒ ğŸ‘¥ âš’ ğŸ’­ ğŸ’½ ğŸ‰ ğŸ•§ ğŸ“ª â®ï¸ ğŸ“¨. ğŸš¥ ğŸ“¤ âš  âª ğŸ­ ğŸ“¨.

    âœ‹ï¸ ğŸ‘† ğŸ’ª ğŸš« ğŸ¤š â•1ï¸âƒ£ âš  âšªï¸â¡ï¸ ğŸšª ğŸ“Ÿ (â®ï¸ `yield`). ğŸ‘€ ğŸŒ– [ğŸ”— â®ï¸ `yield` &amp; `HTTPException`](./dependencies/dependencies-with-yield.md#dependencies-with-yield-and-httpexception){.internal-link target=_blank}

&amp; â¤´ï¸, ğŸ•â” âš™ï¸ ğŸ”— *â¡ ğŸ› ï¸ ğŸ”¢*, ğŸ‘¥ ğŸ“£ âš«ï¸ â®ï¸ ğŸ† `Session` ğŸ‘¥ ğŸ—„ ğŸ”— âšªï¸â¡ï¸ ğŸ‡¸ğŸ‡².

ğŸ‘‰ ğŸ”œ â¤´ï¸ ğŸ¤ ğŸ‘¥ ğŸ‘ ğŸ‘¨â€ğŸ¨ ğŸ•â€ğŸ¦º ğŸ”˜ *â¡ ğŸ› ï¸ ğŸ”¢*, â†©ï¸ ğŸ‘¨â€ğŸ¨ ğŸ”œ ğŸ’­ ğŸ‘ˆ `db` ğŸ”¢ ğŸ† `Session`:

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="24  32  38  47  53"
    {!> ../../../docs_src/sql_databases/sql_app/main.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="22  30  36  45  51"
    {!> ../../../docs_src/sql_databases/sql_app_py39/main.py!}
    ```

!!! info "ğŸ“¡ â„¹"
    ğŸ”¢ `db` ğŸ¤™ ğŸ† `SessionLocal`, âœ‹ï¸ ğŸ‘‰ ğŸ“ (âœ â®ï¸ `sessionmaker()`) "ğŸ—³" ğŸ‡¸ğŸ‡² `Session`,, ğŸ‘¨â€ğŸ¨ ğŸš« ğŸ¤™ ğŸ’­ âš«ï¸â” ğŸ‘©â€ğŸ”¬ ğŸšš.

    âœ‹ï¸ ğŸ“£ ğŸ† `Session`, ğŸ‘¨â€ğŸ¨ ğŸ”œ ğŸ’ª ğŸ’­ ğŸ’ª ğŸ‘©â€ğŸ”¬ (`.add()`, `.query()`, `.commit()`, â™’ï¸) &amp; ğŸ’ª ğŸšš ğŸ‘ ğŸ•â€ğŸ¦º (ğŸ’– ğŸ› ï¸). ğŸ† ğŸ“„ ğŸš« ğŸ“‰ â˜‘ ğŸš.

### âœ ğŸ‘† **FastAPI** *â¡ ğŸ› ï¸*

ğŸ”œ, ğŸ˜’, ğŸ“¥ ğŸ© **FastAPI** *â¡ ğŸ› ï¸* ğŸ“Ÿ.

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="23-28  31-34  37-42  45-49  52-55"
    {!> ../../../docs_src/sql_databases/sql_app/main.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="21-26  29-32  35-40  43-47  50-53"
    {!> ../../../docs_src/sql_databases/sql_app_py39/main.py!}
    ```

ğŸ‘¥ ğŸ— ğŸ’½ ğŸ‰ â­ ğŸ”  ğŸ“¨ ğŸ”— â®ï¸ `yield`, &amp; â¤´ï¸ ğŸ“ª âš«ï¸ â®ï¸.

&amp; â¤´ï¸ ğŸ‘¥ ğŸ’ª âœ ğŸšš ğŸ”— *â¡ ğŸ› ï¸ ğŸ”¢*, ğŸ¤š ğŸ‘ˆ ğŸ‰ ğŸ”—.

â®ï¸ ğŸ‘ˆ, ğŸ‘¥ ğŸ’ª ğŸ¤™ `crud.get_user` ğŸ”— âšªï¸â¡ï¸ ğŸ”˜ *â¡ ğŸ› ï¸ ğŸ”¢* &amp; âš™ï¸ ğŸ‘ˆ ğŸ‰.

!!! tip
    ğŸ‘€ ğŸ‘ˆ ğŸ’² ğŸ‘† ğŸ“¨ ğŸ‡¸ğŸ‡² ğŸ·, âš–ï¸ ğŸ“‡ ğŸ‡¸ğŸ‡² ğŸ·.

    âœ‹ï¸ ğŸŒ *â¡ ğŸ› ï¸* âœ”ï¸ `response_model` â®ï¸ Pydantic *ğŸ·* / ğŸ”— âš™ï¸ `orm_mode`, ğŸ’½ ğŸ“£ ğŸ‘† Pydantic ğŸ· ğŸ”œ âš— âšªï¸â¡ï¸ ğŸ‘« &amp; ğŸ“¨ ğŸ‘©â€ğŸ’», â®ï¸ ğŸŒ ğŸ˜ â›½ &amp; ğŸ”¬.

!!! tip
    ğŸ‘€ ğŸ‘ˆ ğŸ“¤ `response_models` ğŸ‘ˆ âœ”ï¸ ğŸ© ğŸ ğŸ† ğŸ’– `List[schemas.Item]`.

    âœ‹ï¸ ğŸš/ğŸ”¢ ğŸ‘ˆ `List` Pydantic *ğŸ·* â®ï¸ `orm_mode`, ğŸ’½ ğŸ”œ ğŸ—ƒ &amp; ğŸ“¨ ğŸ‘©â€ğŸ’» ğŸ›, ğŸµ âš .

### ğŸ”ƒ `def` ğŸ†š `async def`

ğŸ“¥ ğŸ‘¥ âš™ï¸ ğŸ‡¸ğŸ‡² ğŸ“Ÿ ğŸ”˜ *â¡ ğŸ› ï¸ ğŸ”¢* &amp; ğŸ”—, &amp;, ğŸ”„, âš«ï¸ ğŸ”œ ğŸš¶ &amp; ğŸ”— â®ï¸ ğŸ”¢ ğŸ’½.

ğŸ‘ˆ ğŸ’ª âš  ğŸšš "âŒ›".

âœ‹ï¸ ğŸ‡¸ğŸ‡² ğŸš« âœ”ï¸ ğŸ”— âš™ï¸ `await` ğŸ”—, ğŸ”œ â®ï¸ ğŸ•³ ğŸ’–:

```Python
user = await db.query(User).first()
```

...&amp; â†©ï¸ ğŸ‘¥ âš™ï¸:

```Python
user = db.query(User).first()
```

â¤´ï¸ ğŸ‘¥ ğŸ”œ ğŸ“£ *â¡ ğŸ› ï¸ ğŸ”¢* &amp; ğŸ”— ğŸµ `async def`, â®ï¸ ğŸ˜ `def`,:

```Python hl_lines="2"
@app.get("/users/{user_id}", response_model=schemas.User)
def read_user(user_id: int, db: Session = Depends(get_db)):
    db_user = crud.get_user(db, user_id=user_id)
    ...
```

!!! info
    ğŸš¥ ğŸ‘† ğŸ’ª ğŸ”— ğŸ‘† ğŸ”— ğŸ’½ ğŸ”, ğŸ‘€ [ğŸ” ğŸ—„ (ğŸ”—) ğŸ’½](../advanced/async-sql-databases.md){.internal-link target=_blank}.

!!! note "ğŸ“¶ ğŸ“¡ â„¹"
    ğŸš¥ ğŸ‘† ğŸ˜Ÿ &amp; âœ”ï¸ â¬ ğŸ“¡ ğŸ’¡, ğŸ‘† ğŸ’ª âœ… ğŸ“¶ ğŸ“¡ â„¹ â” ğŸ‘‰ `async def` ğŸ†š `def` ğŸµ [ğŸ”](../async.md#very-technical-details){.internal-link target=_blank} ğŸ©º.

## ğŸ› ï¸

â†©ï¸ ğŸ‘¥ âš™ï¸ ğŸ‡¸ğŸ‡² ğŸ”— &amp; ğŸ‘¥ ğŸš« ğŸšš ğŸ™† ğŸ˜‡ ğŸ”Œ-âš«ï¸ ğŸ‘· â®ï¸ **FastAPI**, ğŸ‘¥ ğŸ’ª ğŸ› ï¸ ğŸ’½ <abbr title="Automatically updating the database to have any new column we define in our models.">ğŸ› ï¸</abbr> â®ï¸ <a href="https://alembic.sqlalchemy.org" class="external-link" target="_blank">âš—</a> ğŸ”—.

&amp; ğŸ“Ÿ ğŸ”— ğŸ‡¸ğŸ‡² &amp; ğŸ‡¸ğŸ‡² ğŸ· ğŸ–– ğŸ ğŸ”¬ ğŸ“, ğŸ‘† ğŸ”œ ğŸ’ª ğŸ­ ğŸ› ï¸ â®ï¸ âš— ğŸµ âœ”ï¸ â FastAPI, Pydantic, âš–ï¸ ğŸ•³ ğŸ™†.

ğŸ ğŸŒŒ, ğŸ‘† ğŸ”œ ğŸ’ª âš™ï¸ ğŸ ğŸ‡¸ğŸ‡² ğŸ· &amp; ğŸš™ ğŸ ğŸ• ğŸ‘† ğŸ“Ÿ ğŸ‘ˆ ğŸš« ğŸ”— **FastAPI**.

ğŸ–¼, ğŸ–¥ ğŸ“‹ ğŸ‘¨â€ğŸ­ â®ï¸ <a href="https://docs.celeryq.dev" class="external-link" target="_blank">ğŸ¥’</a>, <a href="https://python-rq.org/" class="external-link" target="_blank">ğŸ…¿</a>, âš–ï¸ <a href="https://arq-docs.helpmanual.io/" class="external-link" target="_blank">ğŸ“¶</a>.

## ğŸ“„ ğŸŒ ğŸ“

 ğŸ’­ ğŸ‘† ğŸ”œ âœ”ï¸ ğŸ“ ğŸ“› `my_super_project` ğŸ‘ˆ ğŸ”Œ ğŸ§-ğŸ“ ğŸ¤™ `sql_app`.

`sql_app` ğŸ”œ âœ”ï¸ ğŸ“„ ğŸ“:

* `sql_app/__init__.py`: ğŸ› ğŸ“.

* `sql_app/database.py`:

```Python
{!../../../docs_src/sql_databases/sql_app/database.py!}
```

* `sql_app/models.py`:

```Python
{!../../../docs_src/sql_databases/sql_app/models.py!}
```

* `sql_app/schemas.py`:

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python
    {!> ../../../docs_src/sql_databases/sql_app/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python
    {!> ../../../docs_src/sql_databases/sql_app_py39/schemas.py!}
    ```

=== "ğŸ 3ï¸âƒ£.1ï¸âƒ£0ï¸âƒ£ &amp; ğŸ”›"

    ```Python
    {!> ../../../docs_src/sql_databases/sql_app_py310/schemas.py!}
    ```

* `sql_app/crud.py`:

```Python
{!../../../docs_src/sql_databases/sql_app/crud.py!}
```

* `sql_app/main.py`:

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python
    {!> ../../../docs_src/sql_databases/sql_app/main.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python
    {!> ../../../docs_src/sql_databases/sql_app_py39/main.py!}
    ```

## âœ… âš«ï¸

ğŸ‘† ğŸ’ª ğŸ“ ğŸ‘‰ ğŸ“Ÿ &amp; âš™ï¸ âš«ï¸.

!!! info

    ğŸ‘, ğŸ“Ÿ ğŸ¦ ğŸ“¥ ğŸ• ğŸ’¯. ğŸŒ… ğŸ“Ÿ ğŸ‘‰ ğŸ©º.

â¤´ï¸ ğŸ‘† ğŸ’ª ğŸƒ âš«ï¸ â®ï¸ Uvicorn:


<div class="termy">

```console
$ uvicorn sql_app.main:app --reload

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

&amp; â¤´ï¸, ğŸ‘† ğŸ’ª ğŸ“‚ ğŸ‘† ğŸ–¥ <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a>.

&amp; ğŸ‘† ğŸ”œ ğŸ’ª ğŸ”— â®ï¸ ğŸ‘† **FastAPI** ğŸˆ¸, ğŸ‘‚ ğŸ“Š âšªï¸â¡ï¸ ğŸ° ğŸ’½:

<img src="/img/tutorial/sql-databases/image01.png">

## ğŸ”— â®ï¸ ğŸ’½ ğŸ”—

ğŸš¥ ğŸ‘† ğŸ’š ğŸ”¬ ğŸ—„ ğŸ’½ (ğŸ“) ğŸ”—, â¡ FastAPI, â„¹ ğŸš® ğŸš, ğŸš® ğŸ“, ğŸ“, âº, ğŸ”€ ğŸ“Š, â™’ï¸. ğŸ‘† ğŸ’ª âš™ï¸ <a href="https://sqlitebrowser.org/" class="external-link" target="_blank">ğŸ’½ ğŸ–¥ ğŸ—„</a>.

âš«ï¸ ğŸ”œ ğŸ‘€ ğŸ’– ğŸ‘‰:

<img src="/img/tutorial/sql-databases/image02.png">

ğŸ‘† ğŸ’ª âš™ï¸ ğŸ’³ ğŸ—„ ğŸ–¥ ğŸ’– <a href="https://inloop.github.io/sqlite-viewer/" class="external-link" target="_blank">ğŸ—„ ğŸ“‹</a> âš–ï¸ <a href="https://extendsclass.com/sqlite-browser.html" class="external-link" target="_blank">ExtendsClass</a>.

## ğŸ› ğŸ’½ ğŸ‰ â®ï¸ ğŸ› ï¸

ğŸš¥ ğŸ‘† ğŸ’ª ğŸš« âš™ï¸ ğŸ”— â®ï¸ `yield` - ğŸ–¼, ğŸš¥ ğŸ‘† ğŸš« âš™ï¸ **ğŸ 3ï¸âƒ£.7ï¸âƒ£** &amp; ğŸ’ª ğŸš« â "ğŸ›" ğŸ¤” ğŸ”› **ğŸ 3ï¸âƒ£.6ï¸âƒ£** - ğŸ‘† ğŸ’ª âš’ ğŸ†™ ğŸ‰ "ğŸ› ï¸" ğŸ ğŸŒŒ.

"ğŸ› ï¸" ğŸŒ– ğŸ”¢ ğŸ‘ˆ ğŸ•§ ğŸ› ï¸ ğŸ”  ğŸ“¨, â®ï¸ ğŸ“Ÿ ğŸ› ï¸ â­, &amp; ğŸ“Ÿ ğŸ› ï¸ â®ï¸ ğŸ”— ğŸ”¢.

### âœ ğŸ› ï¸

ğŸ› ï¸ ğŸ‘¥ ğŸ”œ ğŸš® (ğŸ”¢) ğŸ”œ âœ ğŸ†• ğŸ‡¸ğŸ‡² `SessionLocal` ğŸ”  ğŸ“¨, ğŸš® âš«ï¸ ğŸ“¨ &amp; â¤´ï¸ ğŸ” âš«ï¸ ğŸ• ğŸ“¨ ğŸ.

=== "ğŸ 3ï¸âƒ£.6ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="14-22"
    {!> ../../../docs_src/sql_databases/sql_app/alt_main.py!}
    ```

=== "ğŸ 3ï¸âƒ£.9ï¸âƒ£ &amp; ğŸ”›"

    ```Python hl_lines="12-20"
    {!> ../../../docs_src/sql_databases/sql_app_py39/alt_main.py!}
    ```

!!! info
    ğŸ‘¥ ğŸš® ğŸ— `SessionLocal()` &amp; ğŸšš ğŸ“¨ `try` ğŸ«.

     &amp; â¤´ï¸ ğŸ‘¥ ğŸ” âš«ï¸ `finally` ğŸ«.

    ğŸ‘‰ ğŸŒŒ ğŸ‘¥ âš’ ğŸ’­ ğŸ’½ ğŸ‰ ğŸ•§ ğŸ“ª â®ï¸ ğŸ“¨. ğŸš¥ ğŸ“¤ âš  âª ğŸ­ ğŸ“¨.

### ğŸ”ƒ `request.state`

`request.state` ğŸ  ğŸ”  `Request` ğŸš. âš«ï¸ ğŸ“¤ ğŸª âŒ ğŸš ğŸ“ ğŸ“¨ âš«ï¸, ğŸ’– ğŸ’½ ğŸ‰ ğŸ‘‰ ğŸ’¼. ğŸ‘† ğŸ’ª âœ ğŸŒ… ğŸ”ƒ âš«ï¸ <a href="https://www.starlette.io/requests/#other-state" class="external-link" target="_blank">ğŸ’ƒ ğŸ©º ğŸ”ƒ `Request` ğŸ‡µğŸ‡¸</a>.

ğŸ‘¥ ğŸ‘‰ ğŸ’¼, âš«ï¸ â„¹ ğŸ‘¥ ğŸšš ğŸ‘ ğŸ’½ ğŸ‰ âš™ï¸ ğŸ”˜ ğŸŒ ğŸ“¨, &amp; â¤´ï¸ ğŸ” â®ï¸ (ğŸ› ï¸).

### ğŸ”— â®ï¸ `yield` âš–ï¸ ğŸ› ï¸

â **ğŸ› ï¸** ğŸ“¥ ğŸ âš«ï¸â” ğŸ”— â®ï¸ `yield` ğŸ”¨, â®ï¸ ğŸ”º:

* âš«ï¸ ğŸšš ğŸŒ– ğŸ“Ÿ &amp; ğŸ‘„ ğŸŒ… ğŸ—.
* ğŸ› ï¸ âœ”ï¸ `async` ğŸ”¢.
    * ğŸš¥ ğŸ“¤ ğŸ“Ÿ âš«ï¸ ğŸ‘ˆ âœ”ï¸ "âŒ›" ğŸ•¸, âš«ï¸ ğŸ’ª "ğŸ«" ğŸ‘† ğŸˆ¸ ğŸ“¤ &amp; ğŸ“‰ ğŸ­ ğŸ–.
    * ğŸ‘ âš«ï¸ ğŸ² ğŸš« ğŸ“¶ âš  ğŸ“¥ â®ï¸ ğŸŒŒ `SQLAlchemy` ğŸ‘·.
    * âœ‹ï¸ ğŸš¥ ğŸ‘† ğŸš® ğŸŒ– ğŸ“Ÿ ğŸ› ï¸ ğŸ‘ˆ âœ”ï¸ ğŸ“š <abbr title="input and output">ğŸ‘¤/ğŸ…¾</abbr> âŒ›, âš«ï¸ ğŸ’ª â¤´ï¸ âš .
* ğŸ› ï¸ ğŸƒ *ğŸ” * ğŸ“¨.
    * , ğŸ”— ğŸ”œ âœ ğŸ”  ğŸ“¨.
    * ğŸ•â” *â¡ ğŸ› ï¸* ğŸ‘ˆ ğŸµ ğŸ‘ˆ ğŸ“¨ ğŸš« ğŸ’ª ğŸ’½.

!!! tip
    âš«ï¸ ğŸ² ğŸ‘ âš™ï¸ ğŸ”— â®ï¸ `yield` ğŸ•â” ğŸ‘« ğŸ¥ƒ âš™ï¸ ğŸ’¼.

!!! info
    ğŸ”— â®ï¸ `yield` ğŸš® â³ **FastAPI**.

    â®ï¸ â¬ ğŸ‘‰ ğŸ”° ğŸ•´ âœ”ï¸ ğŸ–¼ â®ï¸ ğŸ› ï¸ &amp; ğŸ“¤ ğŸ² ğŸ“š ğŸˆ¸ âš™ï¸ ğŸ› ï¸ ğŸ’½ ğŸ‰ ğŸ§¾.

# Розширення OpenAPI { #extending-openapi }

У деяких випадках вам може знадобитися змінити згенеровану схему OpenAPI.

У цьому розділі ви побачите, як це зробити.

## Звичайний процес { #the-normal-process }

Звичайний (типовий) процес виглядає так.

Застосунок `FastAPI` (екземпляр) має метод `.openapi()`, який має повертати схему OpenAPI.

Під час створення об’єкта застосунку реєструється *операція шляху* для `/openapi.json` (або для того, що ви вкажете в `openapi_url`).

Вона просто повертає JSON-відповідь з результатом методу `.openapi()` застосунку.

Типово метод `.openapi()` перевіряє властивість `.openapi_schema`, щоб з’ясувати, чи містить вона дані, і повертає їх.

Якщо даних немає, він генерує їх за допомогою утилітарної функції `fastapi.openapi.utils.get_openapi`.

І ця функція `get_openapi()` отримує як параметри:

* `title`: заголовок OpenAPI, який показується в документації.
* `version`: версія вашого API, напр. `2.5.0`.
* `openapi_version`: версія специфікації OpenAPI, що використовується. Типово — найновіша: `3.1.0`.
* `summary`: короткий підсумок API.
* `description`: опис вашого API; може містити markdown і буде показаний у документації.
* `routes`: список маршрутів; кожен з них — це зареєстрована *операція шляху*. Їх беруть з `app.routes`.

/// info | Інформація

Параметр `summary` доступний в OpenAPI 3.1.0 і вище, підтримується у FastAPI 0.99.0 і вище.

///

## Перевизначення типових значень { #overriding-the-defaults }

Використовуючи наведені вище відомості, ви можете застосувати ту саму утилітарну функцію, щоб згенерувати схему OpenAPI і перевизначити кожну потрібну вам частину.

Наприклад, додаймо <a href="https://github.com/Rebilly/ReDoc/blob/master/docs/redoc-vendor-extensions.md#x-logo" class="external-link" target="_blank">розширення OpenAPI для ReDoc, щоб включити власний логотип</a>.

### Звичайний **FastAPI** { #normal-fastapi }

Спочатку напишіть увесь ваш застосунок **FastAPI** як зазвичай:

{* ../../docs_src/extending_openapi/tutorial001_py39.py hl[1,4,7:9] *}

### Згенеруйте схему OpenAPI { #generate-the-openapi-schema }

Потім використайте ту саму утилітарну функцію, щоб згенерувати схему OpenAPI всередині функції `custom_openapi()`:

{* ../../docs_src/extending_openapi/tutorial001_py39.py hl[2,15:21] *}

### Змініть схему OpenAPI { #modify-the-openapi-schema }

Тепер ви можете додати розширення ReDoc, додавши власний `x-logo` до «об’єкта» `info` у схемі OpenAPI:

{* ../../docs_src/extending_openapi/tutorial001_py39.py hl[22:24] *}

### Кешуйте схему OpenAPI { #cache-the-openapi-schema }

Ви можете використати властивість `.openapi_schema` як «кеш», щоб зберігати згенеровану схему.

Так ваш застосунок не муситиме генерувати схему щоразу, коли користувач відкриває вашу документацію API.

Її буде згенеровано лише один раз, а потім для наступних запитів використовуватиметься та сама закешована схема.

{* ../../docs_src/extending_openapi/tutorial001_py39.py hl[13:14,25:26] *}

### Перевизначте метод { #override-the-method }

Тепер ви можете замінити метод `.openapi()` вашою новою функцією.

{* ../../docs_src/extending_openapi/tutorial001_py39.py hl[29] *}

### Перевірте { #check-it }

Після переходу за посиланням <a href="http://127.0.0.1:8000/redoc" class="external-link" target="_blank">http://127.0.0.1:8000/redoc</a> ви побачите, що використовується ваш власний логотип (у цьому прикладі — логотип **FastAPI**):

<img src="/img/tutorial/extending-openapi/image01.png">

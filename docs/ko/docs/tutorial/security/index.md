# 보안 도입부

보안, 인증 및 인가를 처리하는 많은 방법이 있습니다.

그리고 이것은 일반적으로 복잡하고 "어려운" 주제입니다.

많은 프레임워크와 시스템에서 단지 보안과 인증을 처리하는 것만으로도 엄청난 양의 노력과 (많은 경우 작성된 전체 코드의 50% 또는 그 이상의) 코드가 필요합니다.

**FastAPI**는 모든 보안 관련 명세서를 공부하고 배울 필요 없이, 표준 방식으로, **보안**을 쉽고, 빠르게 처리하는 데 도움이 되는 여러 도구를 제공합니다.

그러나 우선, 몇 가지 작은 개념을 살펴봅시다.

## 빠르게 훑어보기

이 용어들을 전혀 신경 쓰지 않거나 단지 사용자이름 및 비밀번호 바탕의 인증을 사용한 보안을 *당장 지금* 추가해야 한다면, 다음 장으로 건너뛰길 바랍니다.

## OAuth2

OAuth2는 인증 및 인가를 처리하기 위한 여러 방법을 정의하는 명세입니다.

꽤 광범위한 명세이고 여러 복잡한 사용 사례를 다룹니다.

여기에는 "써드 파티"를 사용한 인증 방법이 포함됩니다.

이것은 모든 "페이스북, 구글, 트위터, 깃헙으로 로그인하기" 시스템 밑단에서 사용됩니다.

### OAuth 1

OAuth 1은 OAuth2와 매우 다르며, 통신을 암호화하는 방법을 직접적으로 명세하기 때문에, 더 복잡합니다.

이것은 요즘에는 별로 유행하지 않거나 사용되지 않습니다.

OAuth2는 어떻게 통신을 암호화하는 지 명세하지 않고, HTTPS을 사용하여 애플리케이션이 제공될 것이라 예상합니다.


!!! tip "팁"
    **배포** 부분에서 Traefik 및 Let's Encrypt를 사용하여, HTTPS를 어떻게 무료로 설정하는 지 볼 수 있습니다.


## OpenID 커넥트

OpenID 커넥트는 **OAuth2**를 바탕으로 한, 또다른 명세서입니다.

이것은 단지 OAuth2에서 상대적으로 모호한 몇 가지 사항을 명세해서 OAuth2를 확장하여, 상호운용성을 높입니다.

예를 들어, 구글 로그인은 (밑단에서 OAuth2를 사용하여) OpenID 커넥트를 사용합니다.

그러나 페이스북 로그인은 OpenID 커넥트를 지원하지 않습니다. 자체 OAuth2 기능이 있습니다.

### ("OpenID 커넥트"가 아닌) OpenID

또한 "OpenID" 명세서도 있습니다. 그것은 **OpenID 커넥트**와 동일한 것을 해결하기 위해 시도하지만, OAuth2를 기반으로 하지 않습니다.

따라서, 이것은 완전히 추가적인 시스템입니다.

이것은 요즘에는 별로 유행하지 않거나 사용되지 않습니다.

## OpenAPI

(이전에 Swagger로 알려진) OpenAPI는 (이제는 리눅스 재단의 일부이며) API 구축에 대한 열린 명세서입니다.

**OpenAPI**는 **FastAPi**의 기반입니다.

그것은 다중 자동 대화형 문서 인터페이스, 코드 생성, 기타 등등을 가능하게 만들어줍니다.

OpenAPI는 다중 보안 "스킴"을 설계할 방법이 있습니다.

그것들을 사용하여, 대화형 문서 시스템을 포함한, 모든 표준-기반 도구의 장점을 취할 수 있습니다.

OpenAPI는 다음과 같은 보안 스킴을 정의합니다:

* `apiKey`: 다음 요소로부터 전달 받는 애플리케이션 특정 키:
    * 쿼리 매개변수.
    * 헤더.
    * 쿠키.
* `http`: 다음을 포함한, 표준 HTTP 인증 시스템:
    * `bearer`: OAuth2를 상속 받은 `Bearer ` 값 및 토큰이 있는 헤더 `Authorization`.
    * HTTP 기본 인증.
    * HTTP 다이제스트, 기타 등등.
* `oauth2`: ("흐름"이라고 불리는) 보안을 처리하는 모든 방법.
    * 이 흐름 중 일부는 (구글, 페이스북, 트위터, 깃헙, 기타 등등과 같은) OAuth 2.0 인증 제공자를 구축하는 데 적합합니다.
        * `implicit`
        * `clientCredentials`
        * `authorizationCode`
    * 그러나 동일한 애플리케이션에서 직접 인증을 처리하는 데 완벽하게 사용할 수 있는 하나의 특정 "흐름"이 있습니다:
        * `password`: 몇몇의 다음 장에서 이것의 예시를 다룹니다.
* `openIdConnect`: OAuth2 인증 데이터를 자동으로 검색하는 방법이 있습니다.
    * 이 자동 검색은 OpenID 커넥트 명세서에 정의되어 있습니다.


!!! tip "팁"
    구글, 페이스북, 트위터, 깃헙, 기타 등등과 같은 다른 인증/인가 제공자를 통합하는 것 또한 가능하며 상대적으로 쉽습니다.

    가장 복잡한 문제는 이와 같은 인증/인가 제공자를 구축하는 것이지만, **FastAPI**는, 어려운 작업을 수행하면서, 이것을 쉽게 할 수 있는 도구를 제공합니다.

## **FastAPI** 유틸리티

FastAPI는 이러한 보안 메커니즘의 사용을 단순화하는 `fastapi.security` 모듈에서 보안 스킴 각각에 대한 여러 도구를 제공합니다.

다음 장에서 **FastAPI**가 제공하는 이러한 도구를 사용하여 어떻게 API에 보안을 추가할 수 있는 지 보게 됩니다.

그리고 또한 어떻게 대화형 문서 시스템 내부에 자동으로 통합되는 지 보게 됩니다.
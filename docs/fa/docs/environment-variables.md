# متغیرهای محیطی (Environment Variables)

/// نکته

اگر قبلاً با مفهوم "متغیرهای محیطی" آشنا هستید و می‌دانید چگونه از آن‌ها استفاده کنید، می‌توانید از این بخش عبور کنید.

///

## متغیر محیطی چیست؟

یک **متغیر محیطی** (که به آن **env var** نیز گفته می‌شود) متغیری است که **خارج از کد پایتون** در **سیستم‌عامل** تعریف می‌شود و کد پایتون (یا برنامه‌های دیگر) می‌تواند آن را بخواند.

متغیرهای محیطی برای مدیریت **تنظیمات برنامه**، بخشی از **نصب پایتون** و موارد دیگر کاربرد دارند.

## ایجاد و استفاده از متغیرهای محیطی

شما می‌توانید متغیرهای محیطی را مستقیماً در **ترمینال** ایجاد و استفاده کنید، بدون نیاز به پایتون:

//// تب | لینوکس، macOS، و Windows Bash

<div class="termy">

```console
// ایجاد متغیر محیطی MY_NAME
$ export MY_NAME="Wade Wilson"

// استفاده از متغیر در یک برنامه دیگر، مانند echo
$ echo "Hello $MY_NAME"

Hello Wade Wilson
```

</div>

////

//// تب | Windows PowerShell

<div class="termy">

```console
// ایجاد متغیر محیطی MY_NAME
$ $Env:MY_NAME = "Wade Wilson"

// استفاده از متغیر در برنامه دیگر، مانند echo
$ echo "Hello $Env:MY_NAME"

Hello Wade Wilson
```

</div>

////

## خواندن متغیرهای محیطی در پایتون

شما می‌توانید متغیرهای محیطی را در **خارج از پایتون** تنظیم کنید و سپس آن‌ها را در **پایتون بخوانید**.

مثلاً، فرض کنید فایلی به نام `main.py` دارید:

```python hl_lines="3"
import os

name = os.getenv("MY_NAME", "World")
print(f"Hello {name} from Python")
```

/// نکته

پارامتر دوم تابع [`os.getenv()`](https://docs.python.org/3.8/library/os.html#os.getenv) مقدار پیش‌فرضی است که در صورت عدم وجود متغیر محیطی برگردانده می‌شود.

///

سپس می‌توانید برنامه را اجرا کنید:

//// تب | لینوکس، macOS، Windows Bash

<div class="termy">

```console
// اجرای برنامه بدون تنظیم متغیر محیطی
$ python main.py

// چون متغیر تنظیم نشده است، مقدار پیش‌فرض استفاده می‌شود
Hello World from Python

// تنظیم متغیر محیطی
$ export MY_NAME="Wade Wilson"

// اجرای مجدد برنامه
$ python main.py

// حالا متغیر خوانده شده و مقدار آن استفاده می‌شود
Hello Wade Wilson from Python
```

</div>

////

//// تب | Windows PowerShell

<div class="termy">

```console
// اجرای برنامه بدون تنظیم متغیر محیطی
$ python main.py

// چون متغیر تنظیم نشده است، مقدار پیش‌فرض استفاده می‌شود
Hello World from Python

// تنظیم متغیر محیطی
$ $Env:MY_NAME = "Wade Wilson"

// اجرای مجدد برنامه
$ python main.py

// حالا متغیر خوانده شده و مقدار آن استفاده می‌شود
Hello Wade Wilson from Python
```

</div>

////

متغیرهای محیطی معمولاً برای **پیکربندی** و **تنظیمات** استفاده می‌شوند، زیرا می‌توانند خارج از کد تنظیم شوند و نیازی به ذخیره در مخزن `git` ندارند.

## ایجاد متغیر محیطی برای یک اجرای خاص

می‌توانید یک متغیر محیطی را **فقط برای یک اجرای خاص از یک برنامه** تنظیم کنید:

<div class="termy">

```console
// ایجاد متغیر محیطی فقط برای اجرای برنامه
$ MY_NAME="Wade Wilson" python main.py

// مقدار متغیر محیطی در دسترس است
Hello Wade Wilson from Python

// اجرای مجدد بدون تنظیم متغیر
$ python main.py
Hello World from Python
```

</div>

/// نکته

برای اطلاعات بیشتر، به [The Twelve-Factor App: Config](https://12factor.net/config) مراجعه کنید.

///

## انواع داده و اعتبارسنجی

متغیرهای محیطی فقط می‌توانند **رشته‌های متنی** باشند، زیرا در سطح سیستم‌عامل تنظیم می‌شوند و باید با سایر برنامه‌ها و سیستم‌ها سازگار باشند.

به همین دلیل، **تمام مقادیر خوانده‌شده از متغیرهای محیطی در پایتون، از نوع `str` خواهند بود** و هر گونه **تبدیل یا اعتبارسنجی** باید در کد انجام شود.

## متغیر محیطی `PATH`

متغیر محیطی **`PATH`** متغیری ویژه است که سیستم‌عامل برای پیدا کردن برنامه‌ها از آن استفاده می‌کند.

مقدار `PATH` یک رشته طولانی است که شامل فهرستی از مسیرهای دایرکتوری بوده و در لینوکس و macOS با `:` و در ویندوز با `;` جدا شده‌اند.

مثلاً مقدار `PATH` ممکن است به شکل زیر باشد:

//// تب | لینوکس، macOS

```plaintext
/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
```

سیستم‌عامل هنگام اجرای یک فرمان، ابتدا در مسیرهای زیر به دنبال برنامه مربوطه می‌گردد:

* `/usr/local/bin`
* `/usr/bin`
* `/bin`
* `/usr/sbin`
* `/sbin`

////

//// تب | ویندوز

```plaintext
C:\Program Files\Python312\Scripts;C:\Program Files\Python312;C:\Windows\System32
```

در ویندوز، سیستم‌عامل ابتدا در مسیرهای زیر جستجو می‌کند:

* `C:\Program Files\Python312\Scripts`
* `C:\Program Files\Python312`
* `C:\Windows\System32`

////

### نصب پایتون و به‌روزرسانی `PATH`

//// تب | لینوکس، macOS

اگر پایتون را نصب کنید و در مسیر `/opt/custompython/bin` قرار بگیرد، می‌توانید این مسیر را به `PATH` اضافه کنید:

```plaintext
/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/custompython/bin
```

////

//// تب | ویندوز

اگر پایتون را نصب کنید و در مسیر `C:\opt\custompython\bin` باشد، می‌توانید این مسیر را به `PATH` اضافه کنید:

```plaintext
C:\Program Files\Python312\Scripts;C:\Program Files\Python312;C:\Windows\System32;C:\opt\custompython\bin
```

////

به این ترتیب، وقتی دستور `python` را در ترمینال اجرا کنید، سیستم‌عامل پایتون را در این مسیر پیدا کرده و اجرا می‌کند.

## نتیجه‌گیری

با این اطلاعات، درک اولیه‌ای از **متغیرهای محیطی** و نحوه استفاده از آن‌ها در پایتون پیدا کردید.

همچنین می‌توانید اطلاعات بیشتر را در [ویکی‌پدیا: Environment Variable](https://en.wikipedia.org/wiki/Environment_variable) مطالعه کنید.

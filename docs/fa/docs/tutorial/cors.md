### CORS (ุงุดุชุฑุงฺฉ ููุงุจุน Cross-Origin)

<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" class="external-link" target="_blank">CORS ุง "Cross-Origin"</a> ุจู ุดุฑุงุท ุงุดุงุฑู ุฏุงุฑุฏ ฺฉู ุฏุฑ ุขูุ ฺฉ ูุฑุงูุชโุงูุฏ ฺฉู ุฏุฑ ูุฑูุฑฺฏุฑ ุงุฌุฑุง ูโุดูุฏุ ุดุงูู ฺฉุฏ **JavaScript** ุงุณุช ฺฉู ุจุง ฺฉ ุจฺฉโุงูุฏ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ูโฺฉูุฏุ ุฏุฑุญุงูโฺฉู ุจฺฉโุงูุฏ ุฏุฑ ฺฉ "ูุจุฏุฃ" ูุชูุงูุช ุงุฒ ูุฑุงูุชโุงูุฏ ูุฑุงุฑ ุฏุงุฑุฏ.

---

## ูุจุฏุฃ (Origin)

ฺฉ **ูุจุฏุฃ** ุชุฑฺฉุจ ุงุฒ **ูพุฑูุชฺฉู** (`http`, `https`)ุ **ุฏุงููู** (`myapp.com`, `localhost`, `localhost.tiangolo.com`) ู **ูพูุฑุช** (`80`, `443`, `8080`) ุงุณุช.

ุจูุงุจุฑุงูุ ูููููโูุง ุฒุฑ ูุจุฏุฃูุง ูุชูุงูุช ูุญุณูุจ ูโุดููุฏ:

- `http://localhost`
- `https://localhost`
- `http://localhost:8080`

ุญุช ุงฺฏุฑ ููฺฏ ุฏุฑ `localhost` ุจุงุดูุฏุ ุจู ุฏูู ุชูุงูุช ุฏุฑ **ูพุฑูุชฺฉู** ุง **ูพูุฑุช**ุ ูุจุฏุฃูุง ูุชูุงูุช ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ.

---

## ูุฑุงุญู

ูุฑุถ ฺฉูู ฺฉู ฺฉ ูุฑุงูุชโุงูุฏ ุฏุฑ **ูุฑูุฑฺฏุฑ** ุดูุง ุฏุฑ `http://localhost:8080` ุงุฌุฑุง ูโุดูุฏ ู ฺฉุฏ **JavaScript** ุขู ุฏุฑ ุชูุงุด ุงุณุช ฺฉู ุจุง ฺฉ ุจฺฉโุงูุฏ ุฏุฑ `http://localhost` ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉูุฏ (ฺูู ูพูุฑุช ูุดุฎุต ูุดุฏูุ ูุฑูุฑฺฏุฑ ุจูโุตูุฑุช ูพุดโูุฑุถ **ูพูุฑุช ธฐ** ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑุฏ).

ุฏุฑ ุงู ุญุงูุชุ ูุฑูุฑฺฏุฑ ุงุจุชุฏุง ฺฉ ุฏุฑุฎูุงุณุช **OPTIONS** ุจู **ูพูุฑุช ธฐ** ุงุฑุณุงู ูโฺฉูุฏ. ุงฺฏุฑ ุจฺฉโุงูุฏุ ูุฏุฑูุง ููุงุณุจ ุฑุง ุจุฑุง ูุฌุงุฒ ฺฉุฑุฏู ุงุฑุชุจุงุท ุงุฒ ูุจุฏุฃ ูุชูุงูุช (`http://localhost:8080`) ุงุฑุณุงู ฺฉูุฏุ ูุฑูุฑฺฏุฑ ุงุฌุงุฒู ุฎูุงูุฏ ุฏุงุฏ ฺฉู ุฌุงูุงุงุณฺฉุฑูพุช ุฏุฑ ูุฑุงูุชโุงูุฏุ ุฏุฑุฎูุงุณุช ุงุตู ุฑุง ุจู ุจฺฉโุงูุฏ ุงุฑุณุงู ฺฉูุฏ.

ุจุฑุง ุงู ฺฉุงุฑุ ุจฺฉโุงูุฏ ุจุงุฏ ฺฉ ูุณุช ุงุฒ **ูุจุฏุฃูุง ูุฌุงุฒ** ุฏุงุดุชู ุจุงุดุฏ.

ุฏุฑ ุงู ููุฑุฏุ ุงู ูุณุช ุจุงุฏ ุดุงูู `http://localhost:8080` ุจุงุดุฏ ุชุง ูุฑุงูุชโุงูุฏ (`:8080`) ุจุชูุงูุฏ ุจู ุฏุฑุณุช ฺฉุงุฑ ฺฉูุฏ.

---

## ฺฉุงุฑุงฺฉุชุฑูุง ุนุงู (Wildcards)

ููฺูู ูโุชูุงู ูุณุช **ูุจุฏุฃูุง ูุฌุงุฒ** ุฑุง `"*"` (ุจูโุนููุงู **ฺฉุงุฑุงฺฉุชุฑ ุนุงู**) ุชูุธู ฺฉุฑุฏ ุชุง ูููโ ูุจุฏุฃูุง ูุฌุงุฒ ุจุงุดูุฏ.

ุงูุง ุงู ุฑูุด ููุท ุจุฑุง ุจุฑุฎ ุงุฒ ุงููุงุน ุงุฑุชุจุงุทุงุช ูุงุจู ุงุณุชูุงุฏู ุงุณุช ู ููุงุฑุฏ ฺฉู ุดุงูู **ุงุญุฑุงุฒ ููุช** ูุณุชูุฏ ุฑุง ุดุงูู ููโุดูุฏุ ูุงููุฏ:

- ฺฉูฺฉโูุง
- ูุฏุฑูุง ุงุญุฑุงุฒ ููุช (ูุงููุฏ **Bearer Tokens**)

ูพุณุ ุจุฑุง ุนููฺฉุฑุฏ ุตุญุญุ ุจูุชุฑ ุงุณุช **ูุจุฏุฃูุง ูุฌุงุฒ ุฑุง ุจูโุตูุฑุช ุตุฑุญ ูุดุฎุต ฺฉูุฏ**.

---

## ุงุณุชูุงุฏู ุงุฒ `CORSMiddleware` ุฏุฑ **FastAPI**

ุจุฑุง ูพฺฉุฑุจูุฏ **CORS** ุฏุฑ **FastAPI**ุ ูโุชูุงู ุงุฒ `CORSMiddleware` ุงุณุชูุงุฏู ฺฉุฑุฏ:

1. **ูุงุฑุฏ ฺฉุฑุฏู** `CORSMiddleware`
2. **ุงุฌุงุฏ ฺฉ ูุณุช ุงุฒ ูุจุฏุฃูุง ูุฌุงุฒ** (ุจูโุนููุงู ุฑุดุชูโูุง ูุชู)
3. **ุงุถุงูู ฺฉุฑุฏู ุขู ุจู ุนููุงู Middleware ุจู ุจุฑูุงููโ FastAPI**

ููฺูู ูโุชูุงู ูุดุฎุต ฺฉุฑุฏ ฺฉู ุจฺฉโุงูุฏ ุงุฌุงุฒูโ ููุงุฑุฏ ุฒุฑ ุฑุง ุฏุงุฑุฏ ุง ูู:

- **ุงุญุฑุงุฒ ููุช** (ูุงููุฏ ฺฉูฺฉโูุงุ ูุฏุฑูุง Authorization ู ...)
- **ูุชุฏูุง HTTP ุฎุงุต** (`POST`, `PUT`) ุง ุชูุงู ูุชุฏูุง ุจุง `"*"`
- **ูุฏุฑูุง HTTP ุฎุงุต** ุง ูููโ ุขูโูุง ุจุง `"*"`

{* ../../docs_src/cors/tutorial001.py hl[2,6:11,13:19] *}

---

## ูพุงุฑุงูุชุฑูุง `CORSMiddleware`

ููุฏุงุฑูุง ูพุดโูุฑุถ `CORSMiddleware` **ุจูโุดุฏุช ูุญุฏูุฏโฺฉููุฏู** ูุณุชูุฏ. ุจูุงุจุฑุงูุ ุจุงุฏ ุจูโุทูุฑ **ุตุฑุญ** ูุดุฎุต ฺฉูุฏ ฺฉู ฺู **ูุจุฏุฃูุงุ ูุชุฏูุง ุง ูุฏุฑูุง** ูุฌุงุฒ ูุณุชูุฏ ุชุง ูุฑูุฑฺฏุฑ ุงุฌุงุฒูโ ุงุณุชูุงุฏู ุงุฒ ุขูโูุง ุฑุง ุฏุฑ ฺฉ ุงุฑุชุจุงุท **Cross-Origin** ุจุฏูุฏ.

ูพุงุฑุงูุชุฑูุง ูพุดุชุจุงูโุดุฏู:

- `allow_origins` - ูุณุช ุงุฒ ูุจุฏุฃูุง ูุฌุงุฒ ุจุฑุง ุฏุฑุฎูุงุณุชโูุง **CORS**. ูุซูุง:

  ```python
  ['https://example.org', 'https://www.example.org']
  ```

  ูโุชูุงูุฏ ุงุฒ `['*']` ุจุฑุง ุงุฌุงุฒู ุฏุงุฏู ุจู ุชูุงู ูุจุฏุฃูุง ุงุณุชูุงุฏู ฺฉูุฏ.

- `allow_origin_regex` - ฺฉ **ุนุจุงุฑุช ุจุงูุงุนุฏู (Regex)** ุจุฑุง ุชุทุจู ุจุง ูุจุฏุฃูุง ูุฌุงุฒ. ูุซูุง:

  ```python
  'https://.*\.example\.org'
  ```

- `allow_methods` - ูุณุช ุงุฒ **ูุชุฏูุง HTTP** ฺฉู ุจุฑุง ุฏุฑุฎูุงุณุชโูุง CORS ูุฌุงุฒ ูุณุชูุฏ. ููุฏุงุฑ ูพุดโูุฑุถ `['GET']` ุงุณุช. ูโุชูุงู ุงุฒ `['*']` ุจุฑุง ูุฌุงุฒ ฺฉุฑุฏู ุชูุงู ูุชุฏูุง ุงุณุชูุงุฏู ฺฉุฑุฏ.

- `allow_headers` - ูุณุช ุงุฒ **ูุฏุฑูุง HTTP** ฺฉู ุจุฑุง ุฏุฑุฎูุงุณุชโูุง CORS ูพุดุชุจุงู ูโุดููุฏ. ููุฏุงุฑ ูพุดโูุฑุถ `[]` ุงุณุช. ูโุชูุงู ุงุฒ `['*']` ุจุฑุง ุงุฌุงุฒู ุฏุงุฏู ุจู ุชูุงู ูุฏุฑูุง ุงุณุชูุงุฏู ฺฉุฑุฏ.

  **ูุฏุฑูุง ููุดู ูุฌุงุฒ ุจุฑุง ุฏุฑุฎูุงุณุชโูุง ุณุงุฏูโ CORS**:

  - `Accept`
  - `Accept-Language`
  - `Content-Language`
  - `Content-Type`

- `allow_credentials` - ุชุนู ูโฺฉูุฏ ฺฉู ุขุง ฺฉูฺฉโูุง ุฏุฑ ุฏุฑุฎูุงุณุชโูุง **Cross-Origin** ูพุดุชุจุงู ุดููุฏ ุง ูู. ููุฏุงุฑ ูพุดโูุฑุถ `False` ุงุณุช.

  - ุงฺฏุฑ ููุฏุงุฑ `allow_origins` ุจุฑุงุจุฑ `['*']` ุจุงุดุฏุ ููโุชูุงู ููุฏุงุฑ `allow_credentials` ุฑุง `True` ูุฑุงุฑ ุฏุงุฏ. ุจุงุฏ ูุจุฏุฃูุง ุฑุง **ุตุฑุญุงู** ูุดุฎุต ฺฉูุฏ.

- `expose_headers` - ุชุนู ูโฺฉูุฏ ฺฉู ฺฉุฏุงู ูุฏุฑูุง **ูพุงุณุฎ** ุจุงุฏ ุจุฑุง ูุฑูุฑฺฏุฑ ูุงุจูโุฏุณุชุฑุณ ุจุงุดูุฏ. ููุฏุงุฑ ูพุดโูุฑุถ `[]` ุงุณุช.

- `max_age` - ูุดุฎุต ูโฺฉูุฏ ฺฉู ูุฑูุฑฺฏุฑ ูพุงุณุฎโูุง CORS ุฑุง ุชุง ฺูุฏ **ุซุงูู** ฺฉุด ฺฉูุฏ. ููุฏุงุฑ ูพุดโูุฑุถ `600` ุซุงูู ุงุณุช.

---

## ุงููุงุน ุฏุฑุฎูุงุณุชโูุง CORS

### **ฑ. ุฏุฑุฎูุงุณุชโูุง ูพุดโูพุฑูุงุฒ (Preflight Requests)**

ุฏุฑุฎูุงุณุชโูุง `OPTIONS` ฺฉู ุดุงูู ูุฏุฑูุง `Origin` ู `Access-Control-Request-Method` ูุณุชูุฏ.

ุฏุฑ ุงู ุญุงูุชุ **Middleware** ุฏุฑุฎูุงุณุช ุฑุง ุจุฑุฑุณ ฺฉุฑุฏู ู ุจุง ูุฏุฑูุง ููุงุณุจ CORSุ ูพุงุณุฎ `200` (ูููู) ุง `400` (ูุงูุนุชุจุฑ) ุงุฑุณุงู ูโฺฉูุฏ.

### **ฒ. ุฏุฑุฎูุงุณุชโูุง ุณุงุฏู (Simple Requests)**

ูุฑ ุฏุฑุฎูุงุณุช ฺฉู ุดุงูู **ูุฏุฑ `Origin`** ุจุงุดุฏ. ุฏุฑ ุงู ุญุงูุชุ **Middleware** ุฏุฑุฎูุงุณุช ุฑุง ุจูโุตูุฑุช ุนุงุฏ ูพุฑุฏุงุฒุด ูโฺฉูุฏ ุงูุง ูุฏุฑูุง ููุงุณุจ CORS ุฑุง ุฏุฑ ูพุงุณุฎ ุงุถุงูู ูโฺฉูุฏ.

---

## ุงุทูุงุนุงุช ุจุดุชุฑ

ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑุจุงุฑูโ **CORS**ุ ูโุชูุงูุฏ ูุณุชูุฏุงุช **Mozilla** ุฑุง ุจุฑุฑุณ ฺฉูุฏ:

๐ [Mozilla CORS Documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)

---

## ูฺฉุชู ูู

ููฺูู ูโุชูุงู ุงุฒ `CORSMiddleware` ููุฌูุฏ ุฏุฑ **Starlette** ุจูโุตูุฑุช ูุณุชูู ุงุณุชูุงุฏู ฺฉุฑุฏ:

```python
from starlette.middleware.cors import CORSMiddleware
```

**FastAPI** ุจุฑุฎ **Middlewareูุง** ุฑุง ุฏุฑ `fastapi.middleware` ุจุฑุง ุฑุงุญุช ุชูุณุนูโุฏููุฏฺฏุงู ุงุฑุงุฆู ูโุฏูุฏ. ุงูุง ุจุดุชุฑ Middlewareูุง ููุฌูุฏ ูุณุชููุงู ุงุฒ **Starlette** ฺฏุฑูุชู ุดุฏูโุงูุฏ.
